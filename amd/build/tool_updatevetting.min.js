define(["jquery","jqueryui","core/str"],function(a,b,c){var d={};return d.dialogid="dialog",d.str={},d.init=function(b){if(b)for(var e in b)d[e]=b[e];c.get_strings([{key:"cancel",component:"moodle"},{key:"close",component:"moodle"},{key:"ok",component:"moodle"}]).done(function(a){var b=0;d.str.cancel=a[b++],d.str.close=a[b++],d.str.ok=a[b++]}),d.blockroot=location.href.replace(new RegExp("^(.*?)/tools.*$"),"$1"),d.toolroot=location.href.replace(new RegExp("^(.*?)/tool.php.*$"),"$1"),d.pageid=location.href.replace(new RegExp("^.*?\\bid=([0-9]+)\\b.*$"),"$1"),d.iconroot=a("img.iconhelp").prop("src").replace(new RegExp("/[^/]+$"),""),d.iconedit=d.iconroot+"/i/edit",d.iconremove=d.iconroot+"/i/delete",a("<link/>",{rel:"stylesheet",type:"text/css",href:d.toolroot+"/styles.css"}).appendTo("head"),a("input[type=checkbox][name='submissions[0]']").click(function(){var b=a(this).prop("checked");a("input[type=checkbox][name^=submissions]").not("[name='submissions[0]']").each(function(){a(this).prop("checked",b)})}),a(".submissionid a").click(function(b){var c=a(this).closest(".submissionid").siblings(".presentationtitle").text();return a.ajax({url:a(this).prop("href"),dataType:"text",method:"GET",success:function(a){a=a.substr(a.indexOf('<ul class="nav nav-tabs">')),a=a.substr(a.indexOf("</ul>")),a=a.substr(0,a.indexOf("</form>")),a=a.replace(new RegExp('<div class="paging">.*?</div>',"g"),""),d.open_dialog(b,c,a)}}),b.stopPropagation(),!1})},d.open_dialog=function(b,c,e,f,g,h,i){var j=!0,k=document.getElementById(d.dialogid);d.empty(k)&&(k=document.createElement("DIV"),k.setAttribute("id",d.dialogid),a("body").append(k));var l=a(k);d.empty(l.dialog("instance"))?l.dialog({autoOpen:!1,width:"auto"}):l.dialog("isOpen")&&l.dialog("close"),l.dialog("option","title",c),l.html(e),l.dialog("option","modal",i);var m=[];if(j&&(d.empty(f)&&(f=d.str.ok),d.empty(g)&&(g="ui-icon-check"),d.empty(h)&&(h=function(){a(this).dialog("close")}),m.push({text:f,click:h})),i){var n=d.str.cancel,o=function(){a(this).dialog("close")};m.push({text:n,click:o})}l.dialog("option","buttons",m),l.dialog("open"),b.stopPropagation()},d.close_dialog=function(){a("#"+d.dialogid).dialog("close")},d.empty=function(a){return void 0===a||null===a},d});