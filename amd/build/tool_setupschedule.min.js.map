{"version":3,"sources":["../src/tool_setupschedule.js"],"names":["define","$","JUI","STR","HTML","UNICODE","TOOL","APPLY_NONE","APPLY_CURRENT","APPLY_THISDAY","APPLY_ALLDAYS","sourcesession","sessiontypes","sessiontimeroom","sessioncontent","details","dialogid","str","init","opts","i","wwwroot","location","href","replace","blockroot","toolroot","pageid","length","iconroot","iconedit","iconremove","prop","css","rel","type","appendTo","getScript","loadstrings","Deferred","ajax","txt","regexp","eval","resolve","tools","insertAfter","p","load","r","s","x","html","setup_tools","format_ajax_error","action","schedule","setup_schedule","items","setup_items","submit","set_schedule_html","set_schedule_unassigned","find","each","activecommand","click","evt","id","indexOf","c","substring","a","clean_emptysessions","setup_table_rooms","fix_times_and_rooms","fix_multislot_times","hide_multilang_spans","make_sessions_droppable","make_sessions_draggable","make_sessions_selectable","when","done","document","querySelector","make_sessions_editable","make_rooms_editable","make_slots_editable","make_days_editable","getElementById","moodleerror","substr","status","statusText","container","removeClass","get_non_jquery_classes","addClass","table","count","setup_tbody_rooms","Math","max","data","tbody","rs","cs","is","not","insert_timeroom","lang","extract_main_language","session","get_items","droppable","click_session","draggable","animate","top","left","icons","prepend","room","slot","createTextNode","append","day","make_day_editable","elm","item","selector","trim","val","ids","push","join","initializeschedule","emptyschedule","get_day_selector","unassign_session","insert_sessions","remove","populateschedule","title","get_string","force_single_line","menus","name","create_menu","empty","heading","tag","starttag","endtag","menu","actionfunction","days","form_values","rooms","categories","types","topics","times","keywords","extract_roomname_txt","closest","filter","colSpan","added","min","get","redraw_schedule","open_dialog","ok","show_add_dialog","populateschedule_old","select_session","renumberschedule","index","countslots","slots","countrooms","multiply","pow","ceil","smallschedule","typeregexp","RegExp","charAt","toUpperCase","className","querySelectorAll","prevAll","hasClass","first","eq","cellIndex","schedulenumber","text","scheduleinfo_add","scheduleinfo_remove","getJSON","info","infoicons","value","i_max","rid","icon","scheduleinfo","div","span","innerHTML","update","records","newelm","oldelm","prependTo","replaceWith","add_day","addday","position","daytext","slotstart","hoursmins","roomcounts","slotcounts","slotlengths","slotintervals","increment","extract_duration","finishtime","m","match","starttime","parseInt","abs","roomcount","mode","slotcount","slotlength","slotinterval","range","mins","form_value","starthours","startmins","oldclass","d","before","cssclass","tabtext","tab","renumberslots","set_schedule_colspan","addedday","edit_day","extract_parent_tabday","editday","labelsep","contents","textnodes","boldcenter","hidden","multilangs","editedday","show_edit_dialog","remove_day","removeday","confirmday","alist","show_remove_dialog","targetday","activatetab","extract_day","trigger","removedday","add_roomheadings","addroomheadings","days_checkbox","extract_max_roomcount","html_roomheadings_toprow","html_roomheadings_datarow","add","has_multiroom","roomheadings","insertBefore","addedroomheadings","edit_roomheadings","extract_parent_day","row","extract_parent_row","editroomheadings","nextAll","html_roomheadings_lastrow","updated","applyto","apply","html_roomheadings","editedroomheadings","remove_roomheadings","extract_parent_daytext","removeroomheadings","confirmroomheadings","removedroomheadings","add_room","addroom","roomname","roomtopic","roomtxt","colspan","roomheading","insert_session","addedroom","edit_room","extract_parent_room","langs","detail","editroom","langtext","editedroom","remove_room","removeroom","confirmroom","daydate","dayroomheading","roomindex","daycolspan","rowcolspan","removed","cellcolspan","removeAttr","removedroom","add_slot","addslot","start","finish","days_select","finishhours","finishmins","duration","form_duration","startfinish","form_startfinish","slotstartfinish","addedslot","edit_slot","extract_parent_slot","dayslot","editslot","checkbox","extract_sessionroom","largeroom","multiroom","firstsession","extract_roomcount","editedslot","remove_slot","removeslot","confirmslot","time","removedslot","redraw","hide","show","slotnumber","edit_session","authornames","category","topic","rowspan","parent","editsession","change_rowspan_colspan","editedsession","remove_session","recordid","extract_recordid","removesession","confirmsession","removedsession","targetsession","forceswap","targetIsEmpty","sourceIsEmpty","targetAllRooms","sourceAllRooms","targetAssigned","sourceAssigned","swap","tagName","temptarget","createElement","tempsource","sourceid","targetid","sourceclasses","targetclasses","children","nonempty","emptyAllRooms","emptyclasses","nonemptyclasses","actiontext","actionicon","showcancelbutton","dialogbox","setAttribute","dialog","buttons","canceltext","cancel","cancelfunction","stopPropagation","close_dialog","attr","extract_parent_number","parentclass","extract_type_number","extract_number","extract_active_day","extract_room","extract_slot","prefix","suffix","number","isNaN","extract_room_txt","extract_roomseats_txt","returnnumber","onebyte","twobyte","extract_startfinish_html","extract_time_html","extract_duration_html","extract_roomname_html","extract_room_html","extract_roomseats_html","extract_roomtopic_html","returndetail","extract","nodeType","newrowspan","newcolspan","cellindex","oldrowspan","oldcolspan","html_sessions","insert","insert_time","insert_room","html_time","html_room","after","classes","split","splice","html_tab","html_day","headings","clone","roomseats","html_roomheading","html_slot","classess","html_item","actions","clickhandler","noclickhandler","appendChild","alert","getAttribute","floor","options","currentheadings","allheadingsthisday","allheadingsalldays","select","html_timeroom","r_min","r_max","durationtxt","hours","selected","pad","class","toLowerCase","positions","positionlast","checked","dayname","clone_menu","menuname","dialog_menu","generate_menu","sort","b","found","v","window","console","log","removeAttribute","size","multiple","shorten","content","multilang","values","form_multilang_values","force_simple_html","padlength","padchar","padleft","durationseparator","forEach","rowSpan","s1","parentNode","s2","nextElementSibling","innerText","exec"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the term of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JS required to setup schedule\n *\n * @module      block_maj_submissions/tool_setupschedule\n * @category    output\n * @copyright   Gordon Bateson\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since       2.9\n */\ndefine([\"jquery\", \"jqueryui\", \"core/str\", // split this define statement because\n        \"block_maj_submissions/html\", // \"grunt\" doesn't like long lines of code\n        \"block_maj_submissions/unicode\"], function($, JUI, STR, HTML, UNICODE) {\n\n    /** @alias module:block_maj_submissions/tool_setupschedule */\n    var TOOL = {};\n\n    // constants\n    TOOL.APPLY_NONE    = 0;\n    TOOL.APPLY_CURRENT = 1;\n    TOOL.APPLY_THISDAY = 2;\n    TOOL.APPLY_ALLDAYS = 3;\n\n    TOOL.sourcesession = null;\n\n    // TODO: initialize this array from the PHP script on the server\n    //       blocks/maj_submissions/tools/setupschedule/action.php\n    TOOL.sessiontypes = \"case|event|featured|keynote|lightning|paper|poster|presentation|showcase|virtual|workshop\";\n\n    // define selectors for session child nodes\n    TOOL.sessiontimeroom = \".time, .room\";\n    TOOL.sessioncontent = \".title, .authors, .categorytypetopic, .summary, .scheduleinfo\";\n\n    // define the selectors for room content\n    TOOL.details = {\"roomname\": null, \"roomseats\": null, \"roomtopic\": null};\n\n    // the DOM id of the dialog box\n    TOOL.dialogid = \"dialog\";\n\n    // initialize string cache\n    TOOL.str = {};\n\n    TOOL.init = function(opts) {\n\n        // cache the opts, if any, passed from the server\n        if (opts) {\n            for (var i in opts) {\n                TOOL[i] = opts[i];\n            }\n        }\n\n        // extract URL and block instance id from page URL\n        TOOL.wwwroot = location.href.replace(new RegExp(\"^(.*?)/blocks.*$\"), \"$1\");\n        TOOL.blockroot = location.href.replace(new RegExp(\"^(.*?)/tools.*$\"), \"$1\");\n        TOOL.toolroot = location.href.replace(new RegExp(\"^(.*?)/tool.php.*$\"), \"$1\");\n        TOOL.pageid = location.href.replace(new RegExp(\"^.*?\\\\bid=([0-9]+)\\\\b.*$\"), \"$1\");\n        if ($(\"img.iconhelp\").length==0) {\n            TOOL.iconroot = TOOL.wwwroot + \"/pix\"; // Moodle >= 3.7\n            TOOL.iconedit = TOOL.iconroot + \"/i/edit.svg\";\n            TOOL.iconremove = TOOL.iconroot + \"/i/delete.svg\";\n        } else {\n            TOOL.iconroot = $(\"img.iconhelp\").prop(\"src\").replace(new RegExp(\"/[^/]+$\"), \"\");\n            TOOL.iconedit = TOOL.iconroot + \"/i/edit\";\n            TOOL.iconremove = TOOL.iconroot + \"/i/delete\";\n        }\n\n        // hide \"Session information\" section of form\n        $(\"#id_sessioninfo\").css(\"display\", \"none\");\n\n        // fetch CSS and JS files\n        $(\"<link/>\", {\n            rel: \"stylesheet\", type: \"text/css\",\n            href: TOOL.toolroot + \"/styles.css\"\n        }).appendTo(\"head\");\n\n        $(\"<link/>\", {\n            rel: \"stylesheet\", type: \"text/css\",\n            href: TOOL.blockroot + \"/templates/template.css\"\n        }).appendTo(\"head\");\n\n        $.getScript(TOOL.blockroot + \"/templates/template.js\");\n\n        // In order to delay making the Schedule/Items elements editable\n        // until after all the  strings have loaded, we created a Deferred\n        // object that is resolved when the strings are available\n        var loadstrings = $.Deferred();\n\n        // load the language strings\n        $.ajax({\n            \"url\": TOOL.toolroot + \"/action.php\",\n            \"data\": {\n                \"id\": TOOL.pageid,\n                \"action\": \"loadstrings\"\n            },\n            \"dataType\": \"text\",\n            \"method\": \"GET\",\n            \"success\": function(txt) {\n                var regexp = new RegExp(\"MAJ\", \"g\");\n                // eslint-disable-next-line no-eval\n                eval(txt.replace(regexp, \"TOOL\"));\n                loadstrings.resolve();\n            }\n        });\n\n        // create Tools area\n        var tools = $(\"<div></div>\", {\"id\": \"tools\"}).insertAfter(\"#id_sessioninfo\");\n\n        // populate Tools area\n        var p = {\"id\": TOOL.pageid, \"action\": \"loadtools\"};\n        tools.load(TOOL.toolroot + \"/action.php\", p, function(r, s, x){\n            // r : response text\n            // s : status text (\"success\" or \"error\")\n            // x : XMLHttpRequest object\n            if (s==\"success\") {\n                $(this).html(r);\n                TOOL.setup_tools(this);\n            } else if (s==\"error\") {\n                $(this).html(TOOL.format_ajax_error(p.action, r, x));\n            }\n        });\n\n        // create Schedule area\n        var schedule = $(\"<div></div>\", {\"id\": \"schedule\"}).insertAfter(\"#tools\");\n\n        // populate Schedule area\n        var p = {\"id\": TOOL.pageid, \"action\": \"loadschedule\"};\n        schedule.load(TOOL.toolroot + \"/action.php\", p, function(r, s, x){\n            // r : response text\n            // s : status text (\"success\" or \"error\")\n            // x : XMLHttpRequest object\n            if (s==\"success\") {\n                $(this).html(r);\n                TOOL.setup_schedule(this, loadstrings);\n            } else if (s==\"error\") {\n                $(this).html(TOOL.format_ajax_error(p.action, r, x));\n            }\n        });\n\n        // create Items area\n        var items = $(\"<div></div>\", {\"id\": \"items\", \"class\": \"schedule\"}).insertAfter(\"#schedule\");\n\n        // populate Items area\n        var p = {\"id\": TOOL.pageid, \"action\": \"loaditems\"};\n        items.load(TOOL.toolroot + \"/action.php\", p, function(r, s, x){\n            // r : response text\n            // s : status text (\"success\" or \"error\")\n            // x : XMLHttpRequest object\n            if (s==\"success\") {\n                $(this).html(r);\n                TOOL.setup_items(this, loadstrings);\n            } else if (s==\"error\") {\n                $(this).html(TOOL.format_ajax_error(p.action, r, x));\n            }\n        });\n\n        // set \"schedule_html\" when form is submitted\n        $(\"form.mform\").submit(function(){\n            TOOL.set_schedule_html();\n            TOOL.set_schedule_unassigned();\n        });\n    };\n\n    // ==========================================\n    // setup tools, schedule and items\n    // ==========================================\n\n    TOOL.setup_tools = function(tools) {\n        $(tools).find(\".command\").each(function(){\n            var activecommand = true;\n            $(this).find(\".subcommand\").each(function(){\n                // extract c(ommand) and s(ubcommand)\n                // from id, e.g. add-slot\n                $(this).click(function(evt){\n                    var id = $(this).prop(\"id\");\n                    var i = id.indexOf(\"-\");\n                    var c = id.substring(0, i);\n                    var s = id.substring(i + 1);\n                    var a = c + \"_\" + s;\n                    if (TOOL[a]) {\n                        TOOL[a](evt);\n                    } else if (TOOL[c]) {\n                        TOOL[c](evt, s);\n                    }\n                });\n                activecommand = false;\n            });\n            if (activecommand) {\n                $(this).click(function(evt){\n                    var c = $(this).prop(\"id\");\n                    TOOL[c](evt);\n                });\n            }\n        });\n    };\n\n    TOOL.setup_schedule = function(schedule, loadstrings){\n        TOOL.clean_emptysessions(schedule);\n        TOOL.setup_table_rooms(schedule);\n        TOOL.fix_times_and_rooms(schedule);\n        TOOL.fix_multislot_times(schedule);\n        TOOL.hide_multilang_spans(schedule);\n        TOOL.make_sessions_droppable(schedule);\n        TOOL.make_sessions_draggable(schedule);\n        TOOL.make_sessions_selectable(schedule);\n        $.when(loadstrings).done(function(){\n            var x = document.querySelector(\"table.schedule\");\n            TOOL.make_sessions_editable(x);\n            TOOL.make_rooms_editable(x);\n            TOOL.make_slots_editable(x);\n            TOOL.make_days_editable(x);\n        });\n    };\n\n    TOOL.setup_items = function(items, loadstrings){\n        TOOL.make_sessions_draggable(items);\n        $.when(loadstrings).done(function(){\n            var x = document.getElementById(\"items\");\n            TOOL.make_sessions_selectable(x);\n            TOOL.make_sessions_editable(x);\n        });\n    };\n\n    TOOL.format_ajax_error = function(action, r, x) {\n        var moodleerror = false;\n        var i = r.indexOf('<footer id=\"page-footer\"');\n        if (i >= 0) {\n            r = r.substr(0, i);\n            moodleerror = true;\n        }\n        var i = r.indexOf('<div id=\"page-content\"');\n        if (i >= 0) {\n            r = r.substr(i);\n            moodleerror = true;\n        }\n        if (moodleerror) {\n            // debugging error from Moodle\n            r = r.replace(new RegExp('<form[^>]*>.*?</form>', \"g\"), \"\");\n            r = r.replace(new RegExp('<p class=\"errorcode\">.*?</p>'), \"\");\n            r = r.replace(new RegExp('<div class=\"continuebutton\">.*?</div>'), \"\");\n            return r;\n        }\n        return \"Error (\" + action + \") \" + x.status + \": \" + x.statusText;\n    };\n\n    TOOL.clean_emptysessions = function(container) {\n        $(container).find(\".emptysession\").each(function(){\n            $(this).removeClass(TOOL.get_non_jquery_classes(this)).addClass(\"session emptysession\");\n        });\n    };\n\n    TOOL.setup_table_rooms = function(table) {\n        var count = 0;\n        $(table).find(\"tbody\").each(function(){\n            TOOL.setup_tbody_rooms(this);\n            count = Math.max(count, $(this).data(\"roomcount\"));\n        });\n        $(table).data(\"roomcount\", count);\n    };\n\n    TOOL.setup_tbody_rooms = function(tbody) {\n        var i = [];\n        var count = 0;\n        $(tbody).find(\"tr\").each(function(){\n            var roomx = new RegExp(\"\\\\broom\\\\d+\\\\b\", \"g\");\n            $(this).find(\"th.roomheading\").each(function(r){\n                $(this).prop(\"class\", $(this).prop(\"class\").replace(roomx, \"\"));\n                $(this).addClass(\"room\" + (r + 1));\n            });\n            var r = 0;\n            $(this).find(\"th, td\").each(function(){\n                while (i[r]) {\n                    i[r]--;\n                    r++;\n                }\n                $(this).data(\"room\", r);\n                count = Math.max(count, r);\n                var rs = $(this).prop(\"rowspan\") || 1;\n                var cs = $(this).prop(\"colspan\") || 1;\n                while (cs > 0) {\n                    i[r] = (rs - 1) + (i[r] || 0);\n                    r++;\n                    cs--;\n                }\n                if ($(this).is(\":last-child\")) {\n                    while (r < i.length) {\n                        if (i[r]) {\n                            i[r]--;\n                        }\n                        r++;\n                    }\n                }\n            });\n        });\n        $(tbody).data(\"roomcount\", count);\n    };\n\n    TOOL.fix_times_and_rooms = function(container) {\n        $(container).find(\".session\").not(\".multiroom\").each(function(){\n            TOOL.insert_timeroom(this);\n        });\n    };\n\n    TOOL.hide_multilang_spans = function(container) {\n        var lang = TOOL.extract_main_language();\n        $(container).find(\"span.multilang[lang!=\" + lang + \"]\").css(\"display\", \"none\");\n    };\n\n    TOOL.make_sessions_droppable = function(container, session) {\n        TOOL.get_items(container, session, \"td.session\").droppable({\n            \"accept\": \".session\",\n            \"drop\": function() {\n                $(this).removeClass(\"ui-dropping\");\n                TOOL.click_session(this);\n            },\n            \"out\": function() {\n                $(this).removeClass(\"ui-dropping\");\n            },\n            \"over\": function() {\n                $(this).addClass(\"ui-dropping\");\n            },\n            \"tolerance\": \"pointer\"\n        });\n    };\n\n    TOOL.make_sessions_draggable = function(container, session) {\n        TOOL.get_items(container, session, \".session\").draggable({\n            \"cursor\": \"move\",\n            \"scroll\": true,\n            \"stack\": \".session\",\n            \"start\": function() {\n                TOOL.sourcesession = this;\n                $(this).addClass(\"ui-dragging\");\n                $(this).removeClass(\"ui-selected\");\n                $(this).data(\"startposition\", {\n                    \"top\": $(this).css(\"top\"),\n                    \"left\": $(this).css(\"left\")\n                });\n            },\n            \"stop\": function() {\n                $(this).removeClass(\"ui-dragging\");\n                var p = $(this).data(\"startposition\");\n                if (p) {\n                    $(this).addClass(\"ui-dropping\");\n                    $(this).animate({\n                        \"top\": p.top,\n                        \"left\": p.left\n                    }, function(){\n                        $(this).removeClass(\"ui-dropping\");\n                    });\n                }\n            }\n        });\n    };\n\n    TOOL.make_sessions_selectable = function(container, session) {\n        TOOL.get_items(container, session, \".session\").click(function(){\n            TOOL.click_session(this);\n        });\n    };\n\n    TOOL.make_sessions_editable = function(container, session) {\n        TOOL.get_items(container, session, \".session\").each(function(){\n            var id = $(this).prop(\"id\");\n            if (id.indexOf(\"id_record\")==0) {\n                var icons = TOOL.icons(\"session\");\n                $(this).find(\".title\").prepend(icons);\n            }\n        });\n    };\n\n    TOOL.make_rooms_editable = function(container, room) {\n        TOOL.get_items(container, room, \".roomheadings\").each(function(){\n            $(this).find(\".timeheading\").each(function(){\n                var icons = TOOL.icons(\"roomheadings\");\n                $(this).prepend(icons);\n            });\n            $(this).find(\".roomheading\").each(function(){\n                var icons = TOOL.icons(\"room\");\n                $(this).prepend(icons);\n            });\n        });\n    };\n\n    TOOL.make_slots_editable = function(container, slot) {\n        TOOL.get_items(container, slot, \".slot\").each(function(){\n            $(this).find(\".timeheading\").each(function(){\n                var icons = TOOL.icons(\"slot\");\n                var txt = document.createTextNode(\" \");\n                $(this).append(txt, icons);\n            });\n        });\n    };\n\n    TOOL.make_days_editable = function(container, day) {\n        TOOL.get_items(container, day, \".tab\").each(function(){\n            TOOL.make_day_editable(this);\n        });\n    };\n\n    TOOL.make_day_editable = function(elm) {\n        var icons = TOOL.icons(\"day\");\n        var txt = document.createTextNode(\" \");\n        $(elm).append(txt, icons);\n    };\n\n    TOOL.get_items = function(container, item, selector) {\n        if (item) {\n            return $(item);\n        }\n        return $(container).find(selector);\n    };\n\n    // ==========================================\n    // event handlers for form submit\n    // ==========================================\n\n    TOOL.set_schedule_html = function() {\n        var html = TOOL.trim($(\"#schedule\").html());\n\n        // remove YUI ids\n        html = html.replace(new RegExp(' *\\\\bid=\"yui_[^\"]*\"', \"g\"), \"\");\n\n        // remove jQuery CSS classes\n        html = html.replace(new RegExp(' *\\\\bui-[a-z0-9_-]*', \"g\"), \"\");\n\n        // reset inline styles for hidden multilang SPANs and jquery items\n        html = html.replace(new RegExp(' *\\\\b(display|position|z-index): *[^;\"]*;', \"g\"), \"\");\n\n        // remove leading space from class/style counts\n        html = html.replace(new RegExp('(\\\\b(class|style)=\") +', \"g\"), \"$1\");\n\n        // remove empty class/style attributes\n        html = html.replace(new RegExp(' *\\\\b(class|style)=\" *\"', \"g\"), \"\");\n\n        // standardize attribute order in multilang SPANs\n        html = html.replace(new RegExp('(lang=\"[^\"]*\") (class=\"multilang\")', \"g\"), \"$2 $1\");\n\n        // remove added attributes e.g. style=\"\", from multilang SPANs\n        html = html.replace(new RegExp('(class=\"multilang\") (lang=\"[^\"]*\")[^>]*', \"g\"), \"$1 $2\");\n\n        // remove info about xml namespaces\n        html = html.replace(new RegExp(' *\\\\bxml:\\\\w+=\"[^\"]*\"', \"g\"), \"\");\n\n        // remove \"icons\" elements\n        html = html.replace(new RegExp('<span\\\\b[^>]*class=\"icons\"[^>]*>.*?</span>', \"g\"), \"\");\n\n        // remove the \"schedulechooser\" element\n        html = html.replace(new RegExp('<div\\\\b[^>]*class=\"schedulechooser\"[^>]*>.*?</div>', \"g\"), \"\");\n\n        $(\"input[name=schedule_html]\").val(html);\n    };\n\n    TOOL.set_schedule_unassigned = function() {\n        var ids = [];\n        $(\"#items .session[id^=id_recordid]\").each(function(){\n            ids.push($(this).prop(\"id\").substr(12));\n        });\n        $(\"input[name=schedule_unassigned]\").val(ids.join(\",\"));\n    };\n\n    // ==========================================\n    // handlers for tool commands\n    // ==========================================\n\n    TOOL.initializeschedule = function(evt, day) {\n\n        // empty the current schedule\n        TOOL.emptyschedule(evt, day);\n\n        // initialize each required day\n        $(TOOL.get_day_selector(day)).each(function(){\n        });\n    };\n\n    TOOL.emptyschedule = function(evt, day) {\n        // process all sessions in all slots on the selected day\n        $(TOOL.get_day_selector(day, \" .slot\")).each(function(){\n            var r = 1;\n            $(this).find(\".session\").each(function(){\n                TOOL.unassign_session(this);\n                r++;\n                if ($(this).is(\":last-child\")) {\n                    TOOL.insert_sessions(this, r);\n                }\n            });\n        });\n\n        // remove any \"demo\" sessions in the #items container\n        $(\"#items .session\").not(\"div[id^=id_record]\").each(function(){\n            $(this).remove();\n        });\n    };\n\n    TOOL.populateschedule = function(evt) {\n\n        var title = TOOL.get_string(\"populateschedule\");\n        title = TOOL.force_single_line(title);\n\n        // start HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n\n        // add menus for category, type, topic\n        var menus = {\"selectrooms\": \"\",\n                     \"day\":      \"days\",\n                     \"room\":     \"rooms\",\n                     \"selectitems\": \"\",\n                     \"category\": \"categories\",\n                     \"type\":     \"types\",\n                     \"topic\":    \"topics\",\n                     \"time\":     \"times\",\n                     \"keyword\":  \"keywords\"};\n        for (var name in menus) {\n            var create_menu = TOOL[menus[name]]; // TOOL method to create menu\n            if (TOOL.empty(create_menu)) {\n                // heading\n                var heading = HTML.tag(\"h4\", TOOL.str[name]);\n                html += HTML.starttag(\"tr\", {\"valign\": \"top\"})\n                     + HTML.tag(\"td\", heading, {\"colspan\": \"3\"})\n                     + HTML.endtag(\"tr\");\n            } else {\n                var menu = create_menu(name, \"\", {\"size\": 3});\n                if (menu) {\n                    html += HTML.starttag(\"tr\", {\"valign\": \"top\"})\n                         + HTML.tag(\"th\", TOOL.str[name])\n                         + HTML.tag(\"td\", menu, {\"colspan\": \"2\"})\n                         + HTML.endtag(\"tr\");\n                }\n            }\n        }\n\n        // finish HTML\n        html += \"</tbody></table>\";\n\n        var actionfunction = function(){\n\n            var days = TOOL.form_values(this, \"day\");\n            var rooms = TOOL.form_values(this, \"room\");\n            var categories = TOOL.form_values(this, \"category\");\n            var types = TOOL.form_values(this, \"type\");\n            var topics = TOOL.form_values(this, \"topic\");\n            var times = TOOL.form_values(this, \"time\");\n            var keywords = TOOL.form_values(this, \"keyword\");\n\n            // construct days selector\n            if (days===undefined || days===null || days===\"\") {\n                days = \"\";\n            } else if (typeof(days)==\"string\") {\n                days = \".date:contains('\" + days + \"')\";\n            } else {\n                for (var i=0; i<days.length; i++) {\n                    days[i] = \".date:contains('\" + days[i] + \"')\";\n                }\n                days = days.join(\", \");\n            }\n\n            // construct rooms selector\n            if (rooms===undefined || rooms===null || rooms===\"\") {\n                rooms = \"\";\n            } else if (typeof(rooms)==\"string\") {\n                rooms = \".roomname:contains('\" + TOOL.extract_roomname_txt(rooms) + \"')\";\n            } else {\n                for (var i=0; i<rooms.length; i++) {\n                    rooms[i] = \".roomname:contains('\" + TOOL.extract_roomname_txt(rooms[i]) + \"')\";\n                }\n                rooms = rooms.join(\", \");\n            }\n\n            // extract empty sessions (in the schedule)\n            var empty = $(\".day\");\n            if (days) {\n                empty = empty.find(days).closest(\".day\");\n            }\n            empty = empty.find(\".session\");\n            if (rooms) {\n                empty = empty.find(rooms).closest(\".session\");\n            }\n\n            // remove multi-column and multiroom sessions\n            empty = empty.filter(function(){\n                return (this.colSpan===undefined ||\n                        this.colSpan===null ||\n                        this.colSpan===0 ||\n                        this.colSpan===1);\n            }).filter(\".emptysession:not(.multiroom)\");\n\n            // construct categories selector\n            if (categories===undefined || categories===null || categories===\"\") {\n                categories = \"\";\n            } else if (typeof(categories)==\"string\") {\n                categories = \".category:contains('\" + categories + \"')\";\n            } else {\n                for (var i=0; i<categories.length; i++) {\n                    categories[i] = \".category:contains('\" + categories[i] + \"')\";\n                }\n                categories = categories.join(\", \");\n            }\n\n            // construct types selector\n            if (types===undefined || types===null || types===\"\") {\n                types = \"\";\n            } else if (typeof(types)==\"string\") {\n                types = \".type:contains('\" + types + \"')\";\n            } else {\n                for (var i=0; i<types.length; i++) {\n                    types[i] = \".type:contains('\" + types[i] + \"')\";\n                }\n                types = types.join(\", \");\n            }\n\n            // construct topics selector\n            if (topics===undefined || topics===null || topics===\"\") {\n                topics = \"\";\n            } else if (typeof(topics)==\"string\") {\n                topics = \".topic:contains('\" + topics + \"')\";\n            } else {\n                for (var i=0; i<topics.length; i++) {\n                    topics[i] = \".topic:contains('\" + topics[i] + \"')\";\n                }\n                topics = topics.join(\", \");\n            }\n\n            // construct times selector\n            if (times===undefined || times===null || times===\"\") {\n                times = \"\";\n            } else if (typeof(times)==\"string\") {\n                times = \".times .text:contains('\" + times + \"')\";\n            } else {\n                for (var i=0; i<times.length; i++) {\n                    times[i] = \".times .text:contains('\" + times[i] + \"')\";\n                }\n                times = times.join(\", \");\n            }\n\n            // construct keywords selector\n            if (keywords===undefined || keywords===null || keywords===\"\") {\n                keywords = \"\";\n            } else if (typeof(keywords)==\"string\") {\n                keywords = \".keywords .text:contains('\" + keywords + \"')\";\n            } else {\n                for (var i=0; i<keywords.length; i++) {\n                    keywords[i] = \".keywords .text:contains('\" + keywords[i] + \"')\";\n                }\n                keywords = keywords.join(\", \");\n            }\n\n            // extract target items (to be inserted)\n            var items = $(\"#items .session\");\n            if (categories) {\n                items = items.find(categories).closest(\".session\");\n            }\n            if (types) {\n                items = items.find(types).closest(\".session\");\n            }\n            if (topics) {\n                items = items.find(topics).closest(\".session\");\n            }\n            if (times) {\n                items = items.find(times).closest(\".session\");\n            }\n            if (keywords) {\n                items = items.find(keywords).closest(\".session\");\n            }\n\n            var added = false;\n\n            var max = Math.min(items.length,\n                               empty.length);\n\n            for (var i=(max-1); i>=0; i--) {\n                TOOL.click_session(items.get(i));\n                TOOL.click_session(empty.get(i));\n                added = true;\n            }\n\n            TOOL.redraw_schedule(added);\n            TOOL.open_dialog(evt, title, TOOL.get_string(\"populatedschedule\", max), TOOL.str.ok);\n        };\n\n        TOOL.show_add_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.populateschedule_old = function(evt, day) {\n\n        // Slot allocation rules\n        // =====================\n        // https://stackoverflow.com/questions/2746309/best-fit-scheduling-algorithm\n        // https://www.codeproject.com/Articles/23111/Making-a-Class-Schedule-Using-a-Genetic-Algorithm\n\n        // Hard requirements (if you break one of these, then the schedule is infeasible):\n        // (1) presenters cannot teach twice in the same slot\n\n        // Some soft requirements (can be broken, but the schedule is still feasible):\n        // (2) presenters should not present in consecutive slots\n        // (3) distribute languages equally throughout schedule\n        // (4) distribute sponsors equally throughout schedule\n        // (5) slot should match presentation_times\n        // (6) try to have same topics as previous/next session\n        // (7) try to have same language as previous/next session\n        // (8) try to have same keywords as previous/next session\n\n        // SETTINGS SCREEN:\n        // preference_time_1 => day first_slot last_slot\n        // preference_time_2 => day first_slot last_slot\n        // preference_time_3 => day first_slot last_slot\n        // preference_time_4 => day first_slot last_slot\n\n        // cancel previous clicks on sessions, if any\n        TOOL.select_session();\n\n        // select empty sessions on the selected day\n        var empty = $(TOOL.get_day_selector(day, \" .emptysession:not(.multiroom)\"));\n        if (empty.length==0) {\n            return true;\n        }\n\n        // select all unassigned sessions\n        var items = $(\"#items .session\");\n        if (items.length==0) {\n            return true;\n        }\n\n        // mimic clicks to assign sessions\n        var max = Math.min(items.length,\n                           empty.length);\n        for (var i=(max-1); i>=0; i--) {\n            TOOL.click_session(items.get(i));\n            TOOL.click_session(empty.get(i));\n        }\n        return true;\n    };\n\n    TOOL.renumberschedule = function(evt, day) {\n\n        // initialize array of indexes, counts and multipliers\n        var index = [];\n        var count = {\n            \"days\"  : $(\".day\").length,\n            \"slots\" : 0,\n            \"rooms\" : 0\n        };\n        $(\".day\").each(function(){\n            var countslots = $(this).find(\".slot\").length;\n            count.slots = Math.max(count.slots, countslots);\n        });\n        $(\".day\").each(function(){\n            $(this).find(\".roomheadings\").each(function(){\n                var countrooms = $(this).find(\".roomheading\").length;\n                count.rooms = Math.max(count.rooms, countrooms);\n            });\n        });\n        var multiply = {\n            \"days\"  : Math.pow(10, Math.ceil(count.days  / 10)),\n            \"slots\" : Math.pow(10, Math.ceil(count.slots / 10)),\n            \"rooms\" : Math.pow(10, Math.ceil(count.rooms / 10))\n        };\n        var smallschedule = (count.days < 10 && count.slots < 10 && count.rooms < 10);\n\n        // initialize RegExp's to extract info from CSS class\n        var dayregexp = new RegExp(\"^.*day(\\\\d+).*$\");\n        var slotregexp = new RegExp(\"^.*slot(\\\\d+).*$\");\n        var roomregexp = new RegExp(\"^.*room(\\\\d+).*$\");\n        var typeregexp = new RegExp(\"^.*(\" + TOOL.sessiontypes + \").*$\");\n\n        // select all non-empty sessions on the selected day\n        $(TOOL.get_day_selector(day, \" .session:not(.emptysession):not(.demo)\")).each(function(){\n\n            var day = $(this).closest(\".day\");\n            day = day.prop(\"class\").replace(dayregexp, \"$1\");\n\n            var type = $(this).prop(\"class\").replace(typeregexp, \"$1\").charAt(0).toUpperCase();\n\n            if (this.className.indexOf(\"sharedsession\") >= 0) {\n                var items = this.querySelectorAll(\".item\");\n            } else {\n                var items = [this];\n            }\n\n            for (var i=0; i<items.length; i++) {\n\n                if (smallschedule) {\n\n                    var slot = $(this).closest(\".slot\");\n                    slot = slot.prop(\"class\").replace(slotregexp, \"$1\");\n\n                    var room = $(this).closest(\".slot\").prevAll(\".roomheadings\");\n                    if (room.length==0 || $(this).hasClass(\"multiroom\")) {\n                        var room = 0;\n                    } else {\n                        room = room.first().find(\"th, td\").eq(this.cellIndex);\n                        room = room.prop(\"class\").replace(roomregexp, \"$1\");\n                    }\n\n                    var schedulenumber = (day + slot + room + \"-\" + type);\n\n                } else {\n\n                    if (TOOL.empty(index[day])) {\n                        index[day] = 1;\n                    } else {\n                        index[day]++;\n                    }\n\n                    var schedulenumber = ((day * multiply.slots) + index[day]);\n                    schedulenumber = (schedulenumber + \"-\" + type);\n                }\n\n                $(items[i]).find(\".schedulenumber\").text(schedulenumber);\n            }\n        });\n    };\n\n    TOOL.get_day_selector = function(day, details) {\n        return \".\" + (day==\"alldays\" ? \"day\" : day) + (details ? details : \"\");\n    };\n\n    TOOL.scheduleinfo_add = function() {\n\n        // remove all previous scheduleinfo\n        TOOL.scheduleinfo_remove();\n\n        // request scheduling info from server: \"loadinfo\"\n        var p = {\"id\": TOOL.pageid, \"action\": \"loadinfo\"};\n        $.getJSON(TOOL.toolroot + \"/action.php\", p, function(info){\n            TOOL.info = info;\n            TOOL.infoicons = {};\n            //var multilang = new RegExp('<span[^>]*class=\"multilang\"[^>]*>(.*?)</span>', \"g\");\n            for (var type in TOOL.info.icons) {\n                TOOL.infoicons[type] = {};\n                for (var value in TOOL.info[type]) {\n                    var i_max = TOOL.info[type][value].length;\n                    for (var i=0; i<i_max; i++) {\n                        var rid = TOOL.info[type][value][i];\n                        var session = $(\"#id_recordid_\" + rid);\n                        if (session.length==0) {\n                            continue; // shouldn't happen !!\n                        }\n                        var icon = TOOL.infoicons[type][value];\n                        if (TOOL.empty(icon)) {\n                            var count = 0;\n                            for (icon in TOOL.infoicons[type]) {\n                                count++;\n                            }\n                            if (count >= TOOL.info.icons[type].length) {\n                                icon = value.charAt(0);\n                            } else {\n                                icon = TOOL.info.icons[type][count];\n                            }\n                            TOOL.infoicons[type][value] = icon;\n                        }\n                        var scheduleinfo = session.find(\".scheduleinfo\");\n                        if (scheduleinfo.length==0) {\n                            scheduleinfo = HTML.tag(\"div\", \"\", {\"class\": \"scheduleinfo\"});\n                            scheduleinfo = $(scheduleinfo).appendTo(session);\n                        }\n                        var div = scheduleinfo.find(\".\" + type);\n                        if (div.length==0) {\n                            div = HTML.tag(\"div\", \"\", {\"class\": type});\n                            div = $(div).appendTo(scheduleinfo);\n                        }\n                        var span = false;\n                        // eslint-disable-next-line no-loop-func\n                        div.find(\".text\").each(function(){\n                            if (this.innerHTML==value) {\n                                span = true;\n                            }\n                        });\n                        if (span==false) {\n                            span = HTML.tag(\"span\", icon, {\"class\": \"icon\",}) + HTML.tag(\"span\", value, {\"class\": \"text\"});\n                            span = HTML.tag(\"span\", span, {\"class\": \"icontext\"});\n                            $(span).appendTo(div);\n                        }\n                    }\n                }\n            }\n        });\n    };\n\n    TOOL.scheduleinfo_remove = function() {\n        $(\".scheduleinfo\").remove();\n    };\n\n    TOOL.update = function(evt, type) {\n        var p = {\"id\": TOOL.pageid, \"action\": \"update\", \"type\": type};\n        $.getJSON(TOOL.toolroot + \"/action.php\", p, function(records){\n            for (var rid in records) {\n                for (type in records[rid]) {\n                    var newelm = $(records[rid][type]);\n                    var oldelm = $(\"#id_recordid_\" + rid + \" .\" + type);\n                    oldelm.find(\".icons\").prependTo(newelm);\n                    oldelm.replaceWith(newelm);\n                }\n            }\n        });\n    };\n\n    // ==========================================\n    // handlers to add, edit and remove day\n    // ==========================================\n\n    TOOL.add_day = function(evt) {\n        // specify title\n        var title = TOOL.str.addday;\n\n        var position = TOOL.position(\"day\", $(\".tabs .tab\").length);\n        var daytext = TOOL.days(\"daytext\");\n        var slotstart = TOOL.hoursmins(\"start\", 9, 0);\n\n        // determine number of rooms/slots\n        // and average slot length/interval\n        var roomcounts = {};\n        var slotcounts = {};\n        var slotlengths = {};\n        var slotintervals = {};\n\n        // RegExp to parse start/finish times\n        var startfinish = new RegExp(\"(\\\\d+)\\\\s*:\\\\s*(\\\\d+)\\\\s*-\\\\s*(\\\\d+)\\\\s*:\\\\s*(\\\\d+)\");\n\n        // search the current schedule and pick out default values for the new day\n        $(\"tbody.day\").each(function(){\n\n            TOOL.increment(slotcounts, $(this).find(\".slot\").length);\n\n            $(this).find(\".roomheadings\").each(function(){\n                TOOL.increment(roomcounts, $(this).find(\".roomheading\").length);\n            });\n\n            $(this).find(\".timeheading .duration\").each(function(){\n                TOOL.increment(slotlengths, TOOL.extract_duration($(this).prop(\"class\")));\n            });\n\n            var finishtime = null;\n            $(this).find(\".timeheading .startfinish\").each(function(){\n                var m = $(this).text().match(startfinish);\n                if (m && m.length > 4) {\n                    if (typeof(finishtime)==\"number\") {\n                        var starttime = (60 * parseInt(m[1]) + parseInt(m[2]));\n                        TOOL.increment(slotintervals, Math.abs(starttime - finishtime));\n                    }\n                    finishtime = (60 * parseInt(m[3]) + parseInt(m[4]));\n                }\n            });\n        });\n\n        // set default values for form elements\n        var roomcount = TOOL.mode(roomcounts) || 5;\n        var slotcount = TOOL.mode(slotcounts) || 10;\n        var slotlength = TOOL.mode(slotlengths) || 25;\n        var slotinterval = TOOL.mode(slotintervals) || 5;\n\n        // create form elements\n        roomcount = TOOL.range(\"roomcount\", roomcount, 1, Math.max(10, TOOL.max(roomcounts)));\n        slotcount = TOOL.range(\"slotcount\", slotcount, 1, Math.max(20, TOOL.max(slotcounts)));\n        slotlength = TOOL.mins(\"slotlength\", slotlength, 10, Math.max(120, TOOL.max(slotlengths)));\n        slotinterval = TOOL.mins(\"slotinterval\", slotinterval, 0, Math.max(60, TOOL.max(slotintervals)));\n\n        // create HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.position) + HTML.tag(\"td\", position) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.daytext) + HTML.tag(\"td\", daytext) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.roomcount) + HTML.tag(\"td\", roomcount) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.slotcount) + HTML.tag(\"td\", slotcount) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.slotstart) + HTML.tag(\"td\", slotstart) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.slotlength) + HTML.tag(\"td\", slotlength) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.slotinterval) + HTML.tag(\"td\", slotinterval) + \"</tr>\";\n        html += \"</tbody></table>\";\n\n        // specify action function for dialog button\n        var actionfunction = function(){\n\n            var position     = TOOL.form_value(this, \"position\",     true);\n            var daytext      = TOOL.form_value(this, \"daytext\");\n            var roomcount    = TOOL.form_value(this, \"roomcount\",    true);\n            var slotcount    = TOOL.form_value(this, \"slotcount\",    true);\n            var starthours   = TOOL.form_value(this, \"starthours\",   true);\n            var startmins    = TOOL.form_value(this, \"startmins\",    true);\n            var slotlength   = TOOL.form_value(this, \"slotlength\",   true);\n            var slotinterval = TOOL.form_value(this, \"slotinterval\", true);\n\n            var slotstart = (60 * parseInt(starthours) + parseInt(startmins));\n\n            var oldclass = new RegExp(\"\\\\bday\\\\d+\");\n            $(\"table.schedule\").each(function(){\n\n                var d = 1;\n                var added = false;\n                $(this).find(\"tbody.day\").each(function(index){\n                    if (added==false && position <= index) {\n                        added = true;\n                        $(this).before(TOOL.day(d++, daytext, roomcount, slotcount, slotstart, slotlength, slotinterval));\n                    }\n                    var cssclass = $(this).prop(\"class\").replace(oldclass, \"\");\n                    $(this).prop(\"class\", TOOL.trim(cssclass) + \" day\" + d++);\n                });\n                if (added==false) {\n                    added = true;\n                    $(this).append(TOOL.day(d++, daytext, roomcount, slotcount, slotstart, slotlength, slotinterval));\n                }\n\n                var tabtext = daytext;\n                $(this).find(\".tabs td\").each(function(){\n                    var d = 1;\n                    var added = false;\n                    $(this).find(\"div.tab\").each(function(index){\n                        if (added==false && position <= index) {\n                            added = true;\n                            $(this).before(TOOL.tab(d++, tabtext));\n                        }\n                        var cssclass = $(this).prop(\"class\").replace(oldclass, \"\");\n                        $(this).prop(\"class\", TOOL.trim(cssclass) + \" day\" + d++);\n                    });\n                    if (added==false) {\n                        added = true;\n                        $(this).append(TOOL.tab(d++, tabtext));\n                    }\n                });\n            });\n\n            // renumber all slots on the new day\n            TOOL.renumberslots(position);\n\n            // set colspan of scheduletitle and tabs\n            TOOL.set_schedule_colspan();\n\n            TOOL.redraw_schedule(true);\n\n            TOOL.open_dialog(evt, title, TOOL.str.addedday, TOOL.str.ok);\n        };\n\n        TOOL.show_add_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.edit_day = function(evt) {\n        var day = TOOL.extract_parent_tabday(this);\n\n        var tab = $(this).closest(\".tab\");\n        tab.addClass(\"ui-selected\");\n\n        var title = TOOL.str.editday + TOOL.str.labelsep + day;\n\n        var html = \"\";\n        html += \"<table><tbody>\";\n\n        var name = \"daytext\";\n\n        var span = tab.find(\"span.multilang\");\n        if (span.length==0) {\n            var value = tab.contents().filter(TOOL.textnodes).text();\n            html += \"<tr>\"\n                 + HTML.tag(\"th\", TOOL.str[name])\n                 + HTML.tag(\"td\", HTML.text(name, TOOL.trim(value)))\n                 + \"</tr>\";\n        } else {\n            html += \"<tr>\"\n                 + HTML.tag(\"td\", \"\")\n                 + TOOL.boldcenter(\"td\", TOOL.str[name])\n                 + \"</tr>\";\n            span.each(function(){\n                var lang = $(this).prop(\"lang\");\n                if (lang) {\n                    html += \"<tr>\"\n                         + HTML.tag(\"th\", TOOL.str[lang] ? TOOL.str[lang] : lang)\n                         + HTML.tag(\"td\", HTML.text(name + \"_\" + lang, TOOL.trim($(this).html())))\n                         + \"</tr>\";\n                }\n            });\n        }\n\n        html += \"</tbody></table>\";\n        html += HTML.hidden(\"day\", day);\n\n        var actionfunction = function(){\n            var html = TOOL.multilangs(this, \"daytext\");\n            var day = TOOL.form_value(this, \"day\", true);\n\n            $(\".tab.day\" + day).each(function(){\n                $(this).contents().not(\".icons\").remove();\n                $(this).prepend(html);\n            });\n            $(\".day.day\" + day + \" .date td:first-child\").each(function(){\n                $(this).contents().remove();\n                $(this).prepend(TOOL.force_single_line(html));\n            });\n\n            // update the day display on the Tools submenus\n            $(\".subcommand[id$=day\" + day + \"]\").html(html);\n\n            TOOL.open_dialog(evt, title, TOOL.str.editedday, TOOL.str.ok);\n        };\n\n        TOOL.show_edit_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.remove_day = function(evt) {\n        var day = TOOL.extract_parent_tabday(this);\n\n        var tab = $(this).closest(\".tab\");\n        tab.addClass(\"ui-selected\");\n\n        var lang = TOOL.extract_main_language();\n        var daytext = tab.find(\".multilang[lang=\" + lang + \"]\").html();\n        if (TOOL.empty(daytext)) {\n            var regexp = new RegExp(\"\\\\s*<span[^>]*>.*?</span>\", \"g\");\n            daytext = tab.html().replace(regexp, \"\");\n        }\n        daytext = TOOL.force_single_line(daytext);\n\n        var title = TOOL.str.removeday + TOOL.str.labelsep + day;\n\n        var html = HTML.tag(\"p\", TOOL.str.confirmday);\n        html += HTML.alist(\"ul\", [daytext]);\n        html += HTML.hidden(\"targetday\", day);\n\n        var actionfunction = function(){\n            var targetday = TOOL.form_value(this, \"targetday\", true);\n\n            // remove tab for this day\n            var d = 1;\n            var activatetab = false;\n            var oldclass = new RegExp(\"day\\\\d+\");\n            $(\".tab[class*=day]\").each(function(){\n                var cssclass = $(this).prop(\"class\");\n                var day = TOOL.extract_day(cssclass);\n                if (day==targetday) {\n                    if ($(this).hasClass(\"active\")) {\n                        activatetab = true;\n                    }\n                    $(this).remove();\n                } else {\n                    cssclass = TOOL.trim(cssclass.replace(oldclass, \"\"));\n                    $(this).prop(\"class\", cssclass + \" day\" + d++);\n                }\n            });\n\n            // unassign sessions on the target day\n            $(\".day.day\" + targetday).each(function(){\n                $(this).find(\".session\").each(function(){\n                    TOOL.unassign_session(this, true);\n                });\n            });\n\n            // if this day was active, then make another day active instead\n            if (activatetab) {\n                $(\".tab\").first().trigger(\"click\");\n            }\n\n            // set colspan of scheduletitle and tabs\n            TOOL.set_schedule_colspan();\n\n            // remove this day from the Tools subcommands\n            $(\".subcommand[id$=day\" + targetday + \"]\").remove();\n\n            TOOL.open_dialog(evt, title, TOOL.str.removedday, TOOL.str.ok);\n        };\n\n        TOOL.show_remove_dialog(evt, title, html, actionfunction);\n    };\n\n    // ==========================================\n    // helper functions to count frequencies\n    // when adding a new day\n    // ==========================================\n\n    TOOL.increment = function(a, i) {\n        if (TOOL.empty(a[i])) {\n            a[i] = 1;\n        } else{\n            a[i]++;\n        }\n    };\n\n    TOOL.mode = function(a) {\n        var mode = null;\n        var count = null;\n        for (var i in a) {\n            i = parseInt(i);\n            if (TOOL.empty(count) || count < a[i] || (count==a[i] && mode < i)) {\n                count = a[i];\n                mode = i;\n            }\n        }\n        return (TOOL.empty(mode) ? 0 : mode);\n    };\n\n    TOOL.max = function(a) {\n        var max = null;\n        for (var i in a) {\n            i = parseInt(i);\n            if (TOOL.empty(max) || max < i) {\n                max = i;\n            }\n        }\n        return (TOOL.empty(max) ? 0 : max);\n    };\n\n    // ==========================================\n    // handlers to add, edit and remove room headings\n    // ==========================================\n\n    TOOL.add_roomheadings = function(evt) {\n\n        var title = TOOL.str.addroomheadings;\n\n        // start HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n\n        // add checkboxes for days\n        html += TOOL.days_checkbox(\"days\");\n\n        // add HTML for room names and topics\n        var roomcount = TOOL.extract_max_roomcount();\n        for (var r=1; r<=roomcount; r++) {\n            if (r==1) {\n                html += TOOL.html_roomheadings_toprow();\n            }\n            html += TOOL.html_roomheadings_datarow(null, r);\n        }\n\n        // finish HTML\n        html += \"</tbody></table>\";\n\n        var actionfunction = function(){\n\n            var days = TOOL.form_values(this, \"days_\", true);\n            var rooms = TOOL.form_values(this, \"room_\");\n            var topics = TOOL.form_values(this, \"topic_\");\n\n            var added = false;\n\n            $(\".day\").each(function(){\n                var day = TOOL.extract_day($(this).prop(\"class\"));\n                if (days[day]) {\n                    var add = true;\n                    $(this).find(\"tr\").not(\".date\").each(function(){\n                        if (TOOL.has_multiroom($(this))) {\n                            add = true;\n                        } else if (add) {\n                            if ($(this).is(\":not(.roomheadings)\")) {\n                                TOOL.roomheadings(day, rooms, topics).insertBefore(this);\n                                added = true;\n                            }\n                            add = false;\n                        }\n                    });\n                }\n            });\n\n            TOOL.redraw_schedule(added);\n            TOOL.open_dialog(evt, title, TOOL.str.addedroomheadings, TOOL.str.ok);\n        };\n\n        TOOL.show_add_dialog(evt, title, html, actionfunction);\n\n    };\n\n    TOOL.edit_roomheadings = function(evt) {\n        // extract day number and day text\n        var day = TOOL.extract_parent_day(this);\n        var row = TOOL.extract_parent_row(this);\n        //var daytext = TOOL.extract_parent_daytext(this);\n\n        var title = TOOL.str.editroomheadings;\n\n        // start HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n\n        // add HTML for room names and topics\n        var r = 1;\n        $(this).closest(\"th\").nextAll(\".roomheading\").each(function(){\n            if (r==1) {\n                html += TOOL.html_roomheadings_toprow();\n            }\n            html += TOOL.html_roomheadings_datarow(this, r++);\n        });\n\n        if (r > 1) {\n            html += TOOL.html_roomheadings_lastrow();\n        }\n\n        // finish HTML\n        html += \"</tbody></table>\";\n\n        html += HTML.hidden(\"day\", day);\n        html += HTML.hidden(\"row\", row);\n\n        var updated = false;\n        var actionfunction = function(){\n            var day = TOOL.form_value(this, \"day\", true);\n            var row = TOOL.form_value(this, \"row\", true);\n\n            var rooms = TOOL.form_values(this, \"room_\");\n            var topics = TOOL.form_values(this, \"topic_\");\n            var applyto = TOOL.form_value(this, \"applyto\");\n\n            $(\"tbody.day\").each(function(){\n                var d = TOOL.extract_day($(this).prop(\"class\"));\n                if (applyto==TOOL.APPLY_CURRENT || applyto==TOOL.APPLY_THISDAY) {\n                    var apply = (d==day);\n                } else {\n                    var apply = (applyto==TOOL.APPLY_ALLDAYS);\n                }\n                if (apply) {\n                    $(this).find(\".roomheadings\").each(function(){\n                        if (applyto==TOOL.APPLY_CURRENT) {\n                            apply = (row==TOOL.extract_parent_row(this));\n                        } else {\n                            apply = true;\n                        }\n                        if (apply) {\n                            $(this).replaceWith($(TOOL.html_roomheadings(day, rooms, topics)).each(function(){\n                                TOOL.make_rooms_editable(null, this);\n                            }));\n                            updated = true;\n                        }\n                    });\n                }\n            });\n\n            TOOL.redraw_schedule(updated);\n\n            TOOL.open_dialog(evt, title, TOOL.str.editedroomheadings, TOOL.str.ok);\n        };\n\n        TOOL.show_edit_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.remove_roomheadings = function(evt) {\n        // extract day number and day text\n        var day = TOOL.extract_parent_day(this);\n        var row = TOOL.extract_parent_row(this);\n        var daytext = TOOL.extract_parent_daytext(this);\n\n        var title = TOOL.str.removeroomheadings;\n\n        var html = HTML.tag(\"p\", TOOL.str.confirmroomheadings);\n        html += HTML.alist(\"ul\", [daytext]);\n        html += HTML.hidden(\"day\", day);\n        html += HTML.hidden(\"row\", row);\n\n        var actionfunction = function(){\n            var day = TOOL.form_value(this, \"day\", true);\n            var row = TOOL.form_value(this, \"row\", true);\n            $(\".day.day\" + day).closest(\"table\").find(\"tr:eq(\" + row + \")\").remove();\n            TOOL.open_dialog(evt, title, TOOL.str.removedroomheadings, TOOL.str.ok);\n        };\n\n        TOOL.show_remove_dialog(evt, title, html, actionfunction);\n    };\n\n    // ==========================================\n    // handlers to add, edit and remove room\n    // ==========================================\n\n    TOOL.add_room = function(evt) {\n\n        var title = TOOL.str.addroom;\n\n        // start HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n\n        // add checkboxes for days\n        html += TOOL.days_checkbox(\"days\");\n\n        // fetch array of room positions\n        var position = TOOL.position(\"room\", TOOL.extract_max_roomcount());\n\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.position) + HTML.tag(\"td\", position) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.roomname) + HTML.tag(\"td\", TOOL.rooms(\"roomtxt\")) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.roomtopic) + HTML.tag(\"td\", HTML.text(\"roomtopic\")) + \"</tr>\";\n\n        // finish HTML\n        html += \"</tbody></table>\";\n\n        var actionfunction = function(){\n\n            var days = TOOL.form_values(this, \"days_\", true);\n            var roomtxt = TOOL.form_value(this, \"roomtxt\");\n            var roomtopic = TOOL.form_value(this, \"roomtopic\");\n            var position = TOOL.form_value(this, \"position\", true);\n\n            var added = false;\n\n            $(\".day\").each(function(){\n                var day = TOOL.extract_day($(this).prop(\"class\"));\n                if (days[day]) {\n\n                    // increase colspan for this day\n                    $(this).find(\".date td\").each(function(){\n                        var colspan = $(this).prop(\"colspan\") || 1;\n                        $(this).prop(\"colspan\", colspan + 1);\n                    });\n\n                    // increase colspan for this day\n                    $(this).find(\".roomheadings\").each(function(){\n                        var r = 0;\n                        var added = false;\n                        var oldclass = new RegExp(\"\\\\broom\\\\d+\");\n                        $(this).find(\".roomheading\").each(function(){\n                            r++;\n                            if (added==false && position <= r) {\n                                added = true;\n                                $(this).before(TOOL.roomheading(r, roomtxt, roomtopic));\n                                r++;\n                            }\n                            var cssclass = $(this).prop(\"class\").replace(oldclass, \"\");\n                            $(this).prop(\"class\", TOOL.trim(cssclass) + \" room\" + r);\n                        });\n                        if (added==false) {\n                            r++;\n                            $(this).append(TOOL.roomheading(r, roomtxt, roomtopic));\n                        }\n                    });\n\n                    var html = HTML.tag(\"td\", \"\", {\"class\": \"session emptysession\"});\n                    $(this).find(\".slot\").each(function(){\n                        var added = false;\n                        $(this).find(\".session\").each(function(){\n                            var r = $(this).data(\"room\");\n                            if (added==false) {\n                                if (this.colSpan && this.colSpan > 1) {\n                                    $(this).prop(\"colspan\", this.colSpan + 1);\n                                    added = true;\n                                } else if (position <= r) {\n                                    TOOL.insert_session(html, \"insertBefore\", this);\n                                    added = true;\n                                }\n                            }\n                        });\n                        if (added==false) {\n                            added = true;\n                            TOOL.insert_session(html, \"appendTo\", this);\n                        }\n                    });\n                }\n            });\n\n            // set colspan of scheduletitle and tabs\n            TOOL.set_schedule_colspan();\n\n            TOOL.redraw_schedule(added);\n\n            TOOL.open_dialog(evt, title, TOOL.str.addedroom, TOOL.str.ok);\n        };\n\n        TOOL.show_add_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.edit_room = function(evt) {\n\n        // extract day and room\n        var day = TOOL.extract_parent_day(this);\n        var room = TOOL.extract_parent_room(this);\n\n        var langs = [];\n        var details = {};\n\n        var heading = $(this).closest(\".roomheading\");\n        heading.addClass(\"ui-selected\");\n\n        for (var name in TOOL.details) {\n            var detail = heading.find(\".\" + name);\n            if (detail.length==0) {\n                continue;\n            }\n            details[name] = {};\n            var span = detail.find(\"span.multilang\");\n            if (span.length==0) {\n                details[name] = detail.text();\n                continue;\n            }\n            // eslint-disable-next-line no-loop-func\n            span.each(function(){\n                var lang = $(this).prop(\"lang\");\n                if (lang) {\n                    if (langs.indexOf(lang) < 0) {\n                        langs.push(lang);\n                    }\n                    details[name][lang] = $(this).text();\n                }\n            });\n        }\n\n        var title = TOOL.str.editroom + TOOL.str.labelsep + room;\n\n        var html = \"\";\n        html += \"<table><tbody>\";\n\n        if (langs.length) {\n            html += \"<tr>\" + HTML.tag(\"td\", \"\");\n            for (var i=0; i<langs.length; i++) {\n                var lang = langs[i];\n                var langtext = (TOOL.str[lang] ? TOOL.str[lang] : lang);\n                html += TOOL.boldcenter(\"td\", langtext);\n            }\n            html += \"</tr>\";\n        }\n\n        for (var name in details) {\n            html += \"<tr>\" + HTML.tag(\"th\", TOOL.str[name]);\n            if (langs.length==0) {\n                var value = TOOL.trim(details[name]);\n                html += HTML.tag(\"td\", HTML.text(name, value, 12));\n            } else {\n                for (var i=0; i<langs.length; i++) {\n                    var lang = langs[i];\n                    var value = \"\";\n                    if (typeof(details[name])==\"string\") {\n                        value = TOOL.trim(details[name]);\n                    } else if (details[name][lang]) {\n                        value = TOOL.trim(details[name][lang]);\n                    }\n                    html += HTML.tag(\"td\", HTML.text(name + \"_\" + lang, value));\n                }\n            }\n            html += \"</tr>\";\n        }\n\n        html += \"</tbody></table>\";\n        html += HTML.hidden(\"day\", day);\n        html += HTML.hidden(\"room\", room);\n\n        var actionfunction = function(){\n            var day = TOOL.form_value(this, \"day\", true);\n            var room = TOOL.form_value(this, \"room\", true);\n            var heading = $(\".day\" + day + \" .roomheading.room\" + room);\n            var session = $(\".day\" + day + \" .session .room\" + room);\n            for (var name in TOOL.details) {\n                var html = TOOL.multilangs(this, name);\n                heading.find(\".\" + name).html(html);\n                session.find(\".\" + name).html(html);\n            }\n\n            TOOL.open_dialog(evt, title, TOOL.str.editedroom, TOOL.str.ok);\n        };\n\n        TOOL.show_edit_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.remove_room = function(evt) {\n        // extract day/room number and day text\n        var day = TOOL.extract_parent_day(this);\n        var room = TOOL.extract_parent_room(this);\n        var daytext = TOOL.extract_parent_daytext(this);\n\n        var heading = $(this).closest(\".roomheading\");\n        heading.addClass(\"ui-selected\");\n\n        var title = TOOL.str.removeroom + TOOL.str.labelsep + room;\n\n        var html = HTML.tag(\"p\", TOOL.str.confirmroom);\n        html += \"<table><tbody>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.day) + HTML.tag(\"td\", daytext) + \"</tr>\";\n        for (var name in TOOL.details) {\n            var detail = heading.find(\".\" + name);\n            if (detail.html()) {\n                html += \"<tr>\" + HTML.tag(\"th\", TOOL.str[name]) + HTML.tag(\"td\", detail.html()) + \"</tr>\";\n            }\n        }\n        html += \"</tbody></table>\";\n        html += HTML.hidden(\"day\", day);\n        html += HTML.hidden(\"room\", room);\n\n        var actionfunction = function(){\n            var day = TOOL.form_value(this, \"day\", true);\n            var room = TOOL.form_value(this, \"room\", true);\n\n            var daydate = \".day\" + day + \" .date td\";\n            var dayslots = \".day\" + day + \" .slot\";\n            var dayroomheading = \".day\" + day + \" .roomheading.room\" + room;\n\n            // get col index of the target room\n            var roomindex = $(dayroomheading).index();\n\n            // remove this roomheading\n            $(dayroomheading).remove();\n\n            // unassign any active sessions\n            var daycolspan = 0;\n            $(dayslots).each(function(){\n                var rowcolspan = 0;\n                var removed = false;\n                $(this).find(\"th, td\").each(function(){\n\n                    if (removed) {\n                        rowcolspan++;\n                        return true;\n                    }\n\n                    if (this.colSpan && this.colSpan > 1) {\n                        var cellcolspan = (this.colSpan - 1);\n                        if (cellcolspan==1) {\n                            $(this).removeAttr(\"colspan\");\n                        } else {\n                            $(this).prop(\"colspan\", cellcolspan);\n                        }\n                        rowcolspan += cellcolspan;\n                        removed = true;\n                        return true;\n                    }\n\n                    if ($(this).index()==roomindex) {\n                        TOOL.unassign_session(this, true);\n                        removed = true;\n                        return true;\n                    }\n\n                    rowcolspan++;\n\n                });\n                daycolspan = Math.max(daycolspan, rowcolspan);\n            });\n\n            // reset the colspan on the date cell for this day\n            if (daycolspan > 1) {\n                $(daydate).prop(\"colspan\", daycolspan);\n            } else {\n                $(daydate).removeAttr(\"colspan\");\n            }\n\n            // set colspan of scheduletitle and tabs\n            TOOL.set_schedule_colspan();\n\n            TOOL.open_dialog(evt, title, TOOL.str.removedroom, TOOL.str.ok);\n        };\n\n        TOOL.show_remove_dialog(evt, title, html, actionfunction);\n    };\n\n    // ==========================================\n    // add, edit and remove time slot\n    // ==========================================\n\n    TOOL.add_slot = function(evt) {\n        // specify title\n        var title = TOOL.str.addslot;\n\n        // get form elements\n        var start = TOOL.hoursmins(\"start\");\n        var finish = TOOL.hoursmins(\"finish\");\n        var targetday = TOOL.days_select(\"targetday\");\n\n        // create HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.day) + HTML.tag(\"td\", targetday) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.starttime) + HTML.tag(\"td\", start) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.finishtime) + HTML.tag(\"td\", finish) + \"</tr>\";\n        html += \"</tbody></table>\";\n\n        // specify action function for dialog button\n        var actionfunction = function(){\n\n            var targetday   = TOOL.form_value(this, \"targetday\",   true);\n            var starthours  = TOOL.form_value(this, \"starthours\",  true);\n            var startmins   = TOOL.form_value(this, \"startmins\",   true);\n            var finishhours = TOOL.form_value(this, \"finishhours\", true);\n            var finishmins  = TOOL.form_value(this, \"finishmins\",  true);\n\n            var duration = TOOL.form_duration(starthours, startmins, finishhours, finishmins);\n            var startfinish = TOOL.form_startfinish(starthours, startmins, finishhours, finishmins);\n\n            // create new slot\n            var slot = TOOL.slot(targetday, startfinish, duration);\n\n            // insert html for new slot in the targetday\n            $(\".day.day\" + targetday).find(\".slot\").each(function(){\n                var slotstartfinish = $(this).find(\".timeheading .startfinish\").text();\n                if (slotstartfinish > startfinish) {\n                    slot.insertBefore(this);\n                    slot = null;\n                }\n                // return false to stop each() loop\n                return (TOOL.empty(slot) ? false : true);\n            });\n            if (slot) {\n                // append the new slot at the end of targetday\n                $(\".day.day\" + targetday).append(slot);\n                slot = null;\n            }\n\n            TOOL.redraw_schedule(true);\n\n            // renumber all slots on this day\n            TOOL.renumberslots(targetday);\n\n            TOOL.open_dialog(evt, title, TOOL.str.addedslot, TOOL.str.ok);\n        };\n\n        TOOL.show_add_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.edit_slot = function(evt) {\n\n        // extract day/slot number\n        var day = TOOL.extract_parent_day(this);\n        var slot = TOOL.extract_parent_slot(this);\n        var daytext = TOOL.extract_parent_daytext(this);\n\n        var heading = $(this).closest(\".timeheading\");\n        heading.addClass(\"ui-selected\");\n\n        // extract start/finish times\n        var startfinish = heading.find(\".startfinish\").text();\n        var regexp = new RegExp(\"^.*(\\\\d{2}).*(\\\\d{2}).*(\\\\d{2}).*(\\\\d{2}).*$\");\n        var starthours  = parseInt(startfinish.replace(regexp, \"$1\"));\n        var startmins   = parseInt(startfinish.replace(regexp, \"$2\"));\n        var finishhours = parseInt(startfinish.replace(regexp, \"$3\"));\n        var finishmins  = parseInt(startfinish.replace(regexp, \"$4\"));\n\n        // create JQuery object for the selected slot\n        var dayslot = \".day\" + day + \" .slot\" + slot;\n        var s = $(dayslot);\n\n        // specify title\n        var title = TOOL.str.editslot;\n\n        // get form elements\n        var start = TOOL.hoursmins(\"start\", starthours, startmins);\n        var finish = TOOL.hoursmins(\"finish\", finishhours, finishmins);\n        var checkbox = HTML.checkbox(\"multiroom\", TOOL.has_multiroom(s)) + \" \" + TOOL.rooms(\"roomtxt\", roomname);\n\n        var roomname = TOOL.extract_sessionroom(dayslot + \" .multiroom\", \"name\");\n\n        // create HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.day) + HTML.tag(\"td\", daytext) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.starttime) + HTML.tag(\"td\", start) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.finishtime) + HTML.tag(\"td\", finish) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.largeroom) + HTML.tag(\"td\", checkbox) + \"</tr>\";\n        html += \"</tbody></table>\";\n        html += HTML.hidden(\"day\", day);\n        html += HTML.hidden(\"slot\", slot);\n\n        // specify action function for dialog button\n        var actionfunction = function(){\n\n            var day  = TOOL.form_value(this, \"day\", true);\n            //var slot = TOOL.form_value(this, \"slot\", true);\n            var roomtxt = TOOL.form_value(this, \"roomtxt\");\n            var multiroom = TOOL.form_value(this, \"multiroom\", true);\n            var starthours  = TOOL.form_value(this, \"starthours\", true);\n            var startmins   = TOOL.form_value(this, \"startmins\", true);\n            var finishhours = TOOL.form_value(this, \"finishhours\", true);\n            var finishmins  = TOOL.form_value(this, \"finishmins\", true);\n\n            var duration = TOOL.form_duration(starthours, startmins, finishhours, finishmins);\n            var startfinish = TOOL.form_startfinish(starthours, startmins, finishhours, finishmins);\n\n            // update the start/finish times for this slot\n            $(dayslot + \" .startfinish\").html(startfinish);\n            $(dayslot + \" .duration\").html(TOOL.get_string(\"durationtxt\", duration));\n\n            // update duration class for this slot\n            var oldclass = new RegExp(\"\\\\bduration\\\\w+\");\n            var cssclass = $(dayslot).prop(\"class\").replace(oldclass, \"\");\n            $(dayslot).prop(\"class\",  cssclass + \" duration\" + duration);\n\n            var r = 1;\n            var firstsession = true;\n            var roomcount = TOOL.extract_roomcount(day);\n            $(dayslot + \" .session\").each(function(){\n                if (multiroom) {\n                    // convert to multiroom\n                    if (firstsession) {\n                        firstsession = false;\n                        $(this).addClass(\"multiroom\");\n                        if (roomcount > 1) {\n                            $(this).prop(\"colspan\", roomcount);\n                        }\n                        TOOL.insert_timeroom(this, roomtxt);\n                    } else {\n                        TOOL.unassign_session(this, true);\n                    }\n                } else {\n                    // revert to single rooms\n                    if ($(this).is(\".multiroom\")) {\n                        $(this).removeClass(\"multiroom\");\n                    }\n                    if (this.colSpan) {\n                        $(this).removeAttr(\"colspan\");\n                    }\n                    if ($(this).is(\":not(.emptysession)\")) {\n                        TOOL.insert_timeroom(this);\n                    } else {\n                        $(this).find(TOOL.sessiontimeroom).remove();\n                    }\n                    r++;\n                    if ($(this).is(\":last-child\")) {\n                        TOOL.insert_sessions(this, r, day);\n                    }\n                }\n            });\n\n            TOOL.open_dialog(evt, title, TOOL.str.editedslot, TOOL.str.ok);\n        };\n\n        TOOL.show_edit_dialog(evt, title, html, actionfunction);\n    };\n\n    TOOL.remove_slot = function(evt) {\n\n        // extract day/slot number and day text\n        var day = TOOL.extract_parent_day(this);\n        var slot = TOOL.extract_parent_slot(this);\n        var daytext = TOOL.extract_parent_daytext(this);\n\n        // locate timeheading for this day + slot\n        var dayslot = \".day\" + day + \" .slot\" + slot;\n        var heading = $(dayslot + \" .timeheading\");\n        heading.addClass(\"ui-selected\");\n\n        // extract start/finish time text and duration text\n        var startfinish = heading.find(\".startfinish\").text();\n        var duration = heading.find(\" .duration\").html();\n\n        var title = TOOL.str.removeslot + TOOL.str.labelsep + slot;\n\n        var html = HTML.tag(\"p\", TOOL.str.confirmslot);\n        html += \"<table><tbody>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.day) + HTML.tag(\"td\", daytext) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.time) + HTML.tag(\"td\", startfinish) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.duration) + HTML.tag(\"td\", duration) + \"</tr>\";\n        html += \"</tbody></table>\";\n        html += HTML.hidden(\"day\", day);\n        html += HTML.hidden(\"slot\", slot);\n\n        var actionfunction = function(){\n            var day  = TOOL.form_value(this, \"day\", true);\n            //var slot  = TOOL.form_value(this, \"slot\", true);\n\n            // unassign any active sessions\n            $(dayslot +  \" .session\").each(function(){\n                TOOL.unassign_session(this, true);\n            });\n\n            // remove this slot\n            $(dayslot).remove();\n\n            // renumber remaining slots on this page\n            TOOL.renumberslots(day);\n\n            TOOL.open_dialog(evt, title, TOOL.str.removedslot, TOOL.str.ok);\n        };\n\n        TOOL.show_remove_dialog(evt, title, html, actionfunction);\n    };\n\n    // ==========================================\n    // utility functions used to add/remove\n    // days, room-headings and rooms\n    // ==========================================\n\n    TOOL.redraw_schedule = function(redraw) {\n        // some browsers (at least Chrome on Mac)\n        // need to redraw the schedule after adding tr\n        // rows to the main TABLE holding the schedule\n        if (redraw) {\n            $(\"#schedule\").hide().show(50);\n        }\n    };\n\n    TOOL.set_schedule_colspan = function(colspan) {\n        if (TOOL.empty(colspan)) {\n            colspan = TOOL.extract_max_roomcount() + 1;\n        }\n        $(\".scheduletitle, .tabs\").find(\"td\").prop(\"colspan\", colspan);\n    };\n\n    TOOL.renumberslots = function(day) {\n        var slotnumber = 0;\n        $(\".day.day\" + day).find(\".slot\").each(function(){\n            $(this).prop(\"class\", \"slot slot\" + (slotnumber++));\n        });\n    };\n\n\n    // ==========================================\n    // edit and remove session\n    // ==========================================\n\n    TOOL.edit_session = function(evt) {\n\n        var session = $(this).closest(\".session\");\n\n        // create form elements\n        var title          = HTML.text(\"title\", session.find(\".title\").text(), 50);\n        var authornames    = HTML.text(\"authornames\", session.find(\".authornames\").html(), 50);\n        var schedulenumber = HTML.text(\"schedulenumber\", session.find(\".schedulenumber\").text(), 5);\n        var category       = TOOL.categories(\"category\", session.find(\".category\").html());\n        var type           = TOOL.types(\"type\", session.find(\".type\").html());\n        var topic          = TOOL.topics(\"topic\", session.find(\".topic\").html());\n        var rowspan        = TOOL.range(\"rowspan\", session.prop(\"rowspan\"));\n        var colspan        = TOOL.range(\"colspan\", session.prop(\"colspan\"));\n        var id             = HTML.hidden(\"id\", session.prop(\"id\"));\n\n        // create HTML for dialog\n        var html = \"\";\n        html += \"<table><tbody>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.title)          + HTML.tag(\"td\", title)          + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.authornames)    + HTML.tag(\"td\", authornames)    + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.schedulenumber) + HTML.tag(\"td\", schedulenumber) + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.category)       + HTML.tag(\"td\", category)       + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.type)           + HTML.tag(\"td\", type)           + \"</tr>\";\n        html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.topic)          + HTML.tag(\"td\", topic)          + \"</tr>\";\n        if (session.parent().hasClass(\"slot\")) {\n            html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.rowspan)    + HTML.tag(\"td\", rowspan)        + \"</tr>\";\n            html += \"<tr>\" + HTML.tag(\"th\", TOOL.str.colspan)    + HTML.tag(\"td\", colspan)        + \"</tr>\";\n        }\n        html += \"</tbody></table>\";\n        html += id;\n\n        // specify action function for dialog button\n        var actionfunction = function(){\n\n            // get form values\n            var id             = TOOL.form_value(this, \"id\");\n            var title          = TOOL.form_value(this, \"title\");\n            var authornames    = TOOL.form_value(this, \"authornames\");\n            var schedulenumber = TOOL.form_value(this, \"schedulenumber\");\n            var category       = TOOL.form_value(this, \"category\");\n            var type           = TOOL.form_value(this, \"type\");\n            var topic          = TOOL.form_value(this, \"topic\");\n            var rowspan        = TOOL.form_value(this, \"rowspan\", true);\n            var colspan        = TOOL.form_value(this, \"colspan\", true);\n\n            // update values\n            var session = $(\"#\" + id);\n            session.find(\".title\").contents().filter(TOOL.textnodes).remove();\n            session.find(\".title\").append(title);\n            session.find(\".authornames\").html(authornames);\n            session.find(\".schedulenumber\").text(schedulenumber);\n            session.find(\".category\").html(category);\n            session.find(\".type\").html(type);\n            session.find(\".topic\").html(topic);\n\n            TOOL.change_rowspan_colspan(session, rowspan, colspan);\n\n            TOOL.open_dialog(evt, TOOL.str.editsession, TOOL.str.editedsession, TOOL.str.ok);\n        };\n\n        TOOL.select_session(id);\n        TOOL.show_edit_dialog(evt, TOOL.str.editsession, html, actionfunction);\n    };\n\n    TOOL.remove_session = function(evt) {\n        var id = $(this).closest(\".session\").prop(\"id\");\n        var recordid = TOOL.extract_recordid(id);\n\n        var title = TOOL.str.removesession + \": rid=\" + recordid;\n        var html = HTML.tag(\"p\", TOOL.str.confirmsession);\n        var actionfunction = function(){\n\n            // add new empty session to #items\n            var item = TOOL.item(null, \"session emptysession\").appendTo(\"#items\");\n\n            // deselect current session\n            TOOL.select_session();\n\n            // swap the empty session and the target session\n            TOOL.click_session(item);\n            TOOL.click_session(document.getElementById(id), true);\n\n            TOOL.open_dialog(evt, title, TOOL.str.removedsession, TOOL.str.ok);\n        };\n\n        TOOL.select_session(id);\n        TOOL.show_remove_dialog(evt, title, html, actionfunction);\n    };\n\n    // ==========================================\n    // select/click session\n    // ==========================================\n\n    TOOL.select_session = function(id) {\n        if (TOOL.sourcesession) {\n            TOOL.click_session(TOOL.sourcesession);\n        } else {\n            $(\".ui-selected\").removeClass(\"ui-selected\");\n        }\n        if (id) {\n            TOOL.click_session(document.getElementById(id));\n        }\n    };\n\n    TOOL.click_session = function(targetsession, forceswap) {\n\n        // select source\n        if (TOOL.empty(TOOL.sourcesession)) {\n            TOOL.sourcesession = targetsession;\n            $(targetsession).addClass(\"ui-selected\");\n            return true;\n        }\n\n        // cache flags if target/source is empty\n        var targetIsEmpty = $(targetsession).hasClass(\"emptysession\");\n        var sourceIsEmpty = $(TOOL.sourcesession).hasClass(\"emptysession\");\n\n        // deselect source\n        if (TOOL.sourcesession==targetsession || (sourceIsEmpty && targetIsEmpty)) {\n            $(TOOL.sourcesession).removeClass(\"ui-selected\");\n            $(targetsession).removeClass(\"ui-selected\");\n            TOOL.sourcesession = null;\n            return true;\n        }\n\n        var targetAllRooms = $(targetsession).hasClass(\"multiroom\");\n        var sourceAllRooms = $(TOOL.sourcesession).hasClass(\"multiroom\");\n\n        var targetAssigned = $(targetsession).closest(\"table.schedule\").length;\n        var sourceAssigned = $(TOOL.sourcesession).closest(\"table.schedule\").length;\n\n        // we need to swap these two sessions\n        // if (a) if \"forceswap is TRUE\n        // or (b), both sessions are non-empty\n        // or (c), the sessions have the same tagName\n        // i.e. they are both TD cells in TABLE.schedule\n        // or they are both DIVs in the #items area of the form\n        var swap = (forceswap ? true : false);\n        if (targetIsEmpty==false && sourceIsEmpty==false) {\n            swap = true;\n        }\n        if (targetsession.tagName==TOOL.sourcesession.tagName) {\n            swap = true;\n        }\n\n        if (swap) {\n            $(targetsession).addClass(\"ui-selected\");\n\n            // create temp elements to store child nodes\n            var temptarget = document.createElement(\"DIV\");\n            var tempsource = document.createElement(\"DIV\");\n\n            // transfer DOM ids\n            var sourceid = $(TOOL.sourcesession).prop(\"id\");\n            var targetid = $(targetsession).prop(\"id\");\n            $(TOOL.sourcesession).prop(\"id\", targetid);\n            $(targetsession).prop(\"id\", sourceid);\n\n            // transfer CSS classes\n            var sourceclasses = TOOL.get_non_jquery_classes(TOOL.sourcesession);\n            var targetclasses = TOOL.get_non_jquery_classes(targetsession);\n            $(TOOL.sourcesession).removeClass(sourceclasses).addClass(targetclasses);\n            $(targetsession).removeClass(targetclasses).addClass(sourceclasses);\n\n            // move children to temp source\n            if (sourceAssigned) {\n                if (targetIsEmpty && sourceAllRooms==false) {\n                    $(TOOL.sourcesession).children(TOOL.sessiontimeroom).remove();\n                } else {\n                    $(TOOL.sourcesession).children(TOOL.sessiontimeroom).appendTo(tempsource);\n                }\n            }\n            if (targetIsEmpty==false) {\n                $(targetsession).children(TOOL.sessioncontent).appendTo(tempsource);\n            }\n\n            // move children to temp target\n            if (targetAssigned) {\n                if (sourceIsEmpty && targetAllRooms==false) {\n                    $(targetsession).children(TOOL.sessiontimeroom).remove();\n                } else {\n                    $(targetsession).children(TOOL.sessiontimeroom).appendTo(temptarget);\n                }\n            }\n            if (sourceIsEmpty==false) {\n                $(TOOL.sourcesession).children(TOOL.sessioncontent).appendTo(temptarget);\n            }\n\n            // move children to real source and target\n            $(temptarget).children().appendTo(targetsession);\n            $(tempsource).children().appendTo(TOOL.sourcesession);\n\n            if (sourceAssigned) {\n                if (sourceAllRooms) {\n                    $(TOOL.sourcesession).addClass(\"multiroom\");\n                } else {\n                    $(TOOL.sourcesession).removeClass(\"multiroom\");\n                    if (targetIsEmpty==false) {\n                        TOOL.insert_timeroom(TOOL.sourcesession);\n                    }\n                }\n            }\n            if (targetAssigned) {\n                if (targetAllRooms) {\n                    $(targetsession).addClass(\"multiroom\");\n                } else {\n                    $(targetsession).removeClass(\"multiroom\");\n                    if (targetIsEmpty==false) {\n                        TOOL.insert_timeroom(targetsession);\n                    }\n                }\n            }\n\n            tempsource = null;\n            temptarget = null;\n\n            // deselect TOOL.sourcesession\n            $(TOOL.sourcesession).removeClass(\"ui-selected\");\n            TOOL.sourcesession = null;\n\n            // deselect targetsession\n            $(targetsession).removeClass(\"ui-selected\");\n\n            // finish here\n            return true;\n        }\n\n        // otherwise, one session is empty\n        // and the other is not empty\n\n        var empty = null;\n        var nonempty = null;\n\n        // if source is empty and target is not, then\n        // move target to source, then remove target\n        if (sourceIsEmpty && targetIsEmpty==false) {\n            empty = TOOL.sourcesession;\n            nonempty = targetsession;\n        }\n\n        // if target is empty and source is not, then\n        // move source to target, then remove source\n        if (sourceIsEmpty==false && targetIsEmpty) {\n            empty = targetsession;\n            nonempty = TOOL.sourcesession;\n        }\n\n        if (empty && nonempty) {\n\n            $(empty).addClass(\"ui-selected\");\n\n            // transfer DOM \"id\"\n            $(empty).prop(\"id\", $(nonempty).prop(\"id\"));\n\n            // set flag if empty session uses All Rooms\n            var emptyAllRooms = $(empty).is(\".multiroom\");\n\n            // transfer CSS classes\n            var emptyclasses = TOOL.get_non_jquery_classes(empty);\n            var nonemptyclasses = TOOL.get_non_jquery_classes(nonempty);\n            $(empty).removeClass(emptyclasses).addClass(nonemptyclasses);\n\n            // remove child nodes and transfer time/room details\n            if (emptyAllRooms) {\n                $(empty).addClass(\"multiroom\");\n                $(empty).children().not(TOOL.sessiontimeroom).remove();\n            } else {\n                $(empty).removeClass(\"multiroom\");\n                $(empty).children().remove();\n                TOOL.insert_timeroom(empty);\n            }\n\n            // transfer content elements\n            $(nonempty).children(TOOL.sessioncontent).appendTo(empty);\n\n            // deselect empty session\n            $(empty).removeClass(\"ui-selected\");\n\n            // the nonempty session is now empty\n            // and can be removed from the DOM\n            $(nonempty).remove();\n\n            // release TOOL.sourcesession\n            TOOL.sourcesession = null;\n\n            return true;\n        }\n    };\n\n    // ==========================================\n    // open/close dialog\n    // ==========================================\n\n    TOOL.show_add_dialog = function(evt, title, html, actionfunction) {\n        TOOL.open_dialog(evt, title, html, TOOL.str.add, null, actionfunction, true);\n    };\n\n    TOOL.show_edit_dialog = function(evt, title, html, actionfunction) {\n        TOOL.open_dialog(evt, title, html, TOOL.str.update, null, actionfunction, true);\n    };\n\n    TOOL.show_remove_dialog = function(evt, title, html, actionfunction) {\n        TOOL.open_dialog(evt, title, html, TOOL.str.remove, null, actionfunction, true);\n    };\n\n    TOOL.open_dialog = function(evt, title, html, actiontext, actionicon, actionfunction, showcancelbutton) {\n        var showactionbutton = true;\n\n        // locate dialog box in DOM\n        // (create it, if necessary)\n        var dialogbox = document.getElementById(TOOL.dialogid);\n        if (TOOL.empty(dialogbox)) {\n            dialogbox = document.createElement(\"DIV\");\n            dialogbox.setAttribute(\"id\", TOOL.dialogid);\n            $(\"body\").append(dialogbox);\n        }\n\n        // cache jQuery object for dialog\n        var dialog = $(dialogbox);\n\n        // create/close the dialog element\n        if (TOOL.empty(dialog.dialog(\"instance\"))) {\n            dialog.dialog({\"autoOpen\": false, \"close\": TOOL.select_session, \"width\": \"auto\"});\n        } else {\n            if (dialog.dialog(\"isOpen\")) {\n                dialog.dialog(\"close\");\n            }\n        }\n\n        // update the dialog title\n        dialog.dialog(\"option\", \"title\", title);\n\n        // update the dialog HTML\n        dialog.html(html);\n\n        // set the dialog mode\n        dialog.dialog(\"option\", \"modal\", showcancelbutton);\n\n        // update the dialog buttons\n        var buttons = [];\n        if (showactionbutton) {\n            if (TOOL.empty(actiontext)) {\n                actiontext = TOOL.str.ok;\n            }\n            if (TOOL.empty(actionicon)) {\n                actionicon = \"ui-icon-check\";\n            }\n            if (TOOL.empty(actionfunction)) {\n                actionfunction = function(){\n                    $(this).dialog(\"close\");\n                };\n            }\n            buttons.push({\"text\": actiontext,\"click\": actionfunction}); // \"icon\": actionicon\n        }\n        if (showcancelbutton) {\n            var canceltext = TOOL.str.cancel;\n            //var cancelicon = \"ui-icon-cancel\";\n            var cancelfunction = function(){\n                $(this).dialog(\"close\");\n                TOOL.select_session();\n            };\n            buttons.push({\"text\": canceltext, \"click\": cancelfunction}); // \"icon\": cancelicon\n        }\n        dialog.dialog(\"option\", \"buttons\", buttons);\n\n        // open the dialog box\n        dialog.dialog(\"open\");\n\n        // prevent the current click causing\n        // the parent element to be selected\n        evt.stopPropagation();\n    };\n\n    TOOL.close_dialog = function() {\n        $(\"#\" + TOOL.dialogid).dialog(\"close\");\n    };\n\n    // ==========================================\n    // helper functions to extract info from DOM\n    // ==========================================\n\n    TOOL.has_multiroom = function(slot) {\n        return (slot.find(\".session\").filter(TOOL.colspan).length > 0);\n    };\n\n    TOOL.extract_main_language = function() {\n        var regexp = new RegExp(\"lang-(\\\\w+)\");\n        return $(\"body\").attr('class').match(regexp)[1];\n    };\n\n    TOOL.extract_parent_daytext = function(elm) {\n        var daytext = $(elm).closest(\".day\").find(\".date td\");\n        if (daytext.length==0) {\n            return \"\";\n        }\n        return TOOL.force_single_line(daytext.first().html());\n    };\n\n    TOOL.extract_parent_row = function(elm) {\n        return $(elm).closest(\"tr\").prop(\"rowIndex\");\n    };\n\n    TOOL.extract_parent_day = function(elm) {\n        return TOOL.extract_parent_number(elm, \"day\", \"day\");\n    };\n\n    TOOL.extract_parent_tabday = function(elm) {\n        return TOOL.extract_parent_number(elm, \"tab\", \"day\");\n    };\n\n    TOOL.extract_parent_room = function(elm) {\n        return TOOL.extract_parent_number(elm, \"roomheading\", \"room\");\n    };\n\n    TOOL.extract_parent_slot = function(elm) {\n        return TOOL.extract_parent_number(elm, \"slot\", \"slot\");\n    };\n\n    TOOL.extract_parent_number = function(elm, parentclass, type) {\n        var str = $(elm).closest(\".\" + parentclass).prop(\"class\");\n        return TOOL.extract_type_number(str, type);\n    };\n\n    TOOL.extract_recordid = function(id) {\n        return TOOL.extract_number(id, \"id_recordid_\", \"\");\n    };\n\n    TOOL.extract_active_day = function() {\n        return TOOL.extract_day($(\".tab.active\").prop(\"class\"));\n    };\n\n    TOOL.extract_day = function(str) {\n        return TOOL.extract_type_number(str, \"day\");\n    };\n\n    TOOL.extract_room = function(str) {\n        return TOOL.extract_type_number(str, \"room\");\n    };\n\n    TOOL.extract_slot = function(str) {\n        return TOOL.extract_type_number(str, \"slot\");\n    };\n\n    TOOL.extract_duration = function(str) {\n        return TOOL.extract_number(str, \".*\\\\bduration\", \"\\\\b.*\");\n    };\n\n    TOOL.extract_type_number = function(str, type) {\n        return TOOL.extract_number(str, \".*\\\\b\" + type, \"\\\\b.*\");\n    };\n\n    TOOL.extract_number = function(str, prefix, suffix) {\n        if (typeof(str)==\"string\") {\n            var pattern = \"^\" + prefix + \"(\\\\d+)\" + suffix + \"$\";\n            var number = str.replace(new RegExp(pattern), \"$1\");\n            return (isNaN(number) ? 0 : parseInt(number));\n        }\n        return 0;\n    };\n\n    TOOL.extract_roomcount = function(day) {\n        return $(\".day.day\" + day).data(\"roomcount\");\n    };\n\n    TOOL.extract_max_roomcount = function(day) {\n        var max = 0, days = \".day\";\n        if (day) {\n            days += \".day\" + day;\n        }\n        $(days).each(function(){\n            var day = TOOL.extract_parent_day(this);\n            max = Math.max(max, TOOL.extract_roomcount(day));\n        });\n        return max;\n    };\n\n    TOOL.extract_roomname_txt = function(txt) {\n        return TOOL.extract_room_txt(txt);\n    };\n\n    TOOL.extract_roomseats_txt = function(txt) {\n        return TOOL.extract_room_txt(txt, true);\n    };\n\n    TOOL.extract_room_txt = function(txt, returnnumber) {\n        // e.g. Room 101 (20 seats)\n        if (txt==TOOL.trim(txt)) {\n            if (txt.indexOf('class=\"multilang\"') < 0) {\n                var onebyte = new RegExp(\"^(.*)\\\\((.*?)\\\\)(.*?)$\");\n                var twobyte = new RegExp(\"^(.*)\\uff08(.*?)\\uff09(.*?)$\");\n                var replace = (returnnumber ? \"$2\" : \"$1$3\");\n            } else {\n                var onebyte = new RegExp(\"(<span[^>]*>)([^<]*?)\\\\((.*?)\\\\)(.*?)(</span>)\");\n                var twobyte = new RegExp(\"(<span[^>]*>)([^<]*?)\\uff08(.*?)\\uff09(.*?)(</span>)\");\n                var replace = (returnnumber ? \"$1$3$5\" : \"$1$2$4$5\");\n            }\n            txt = txt.replace(onebyte, replace).replace(twobyte, replace);\n        }\n        return txt;\n    };\n\n    TOOL.extract_startfinish_html = function(day, slot) {\n        return TOOL.extract_time_html(day, slot, \"startfinish\");\n    };\n\n    TOOL.extract_duration_html = function(day, slot) {\n        return TOOL.extract_time_html(day, slot, \"duration\");\n    };\n\n    TOOL.extract_time_html = function(day, slot, name) {\n        return $(\".day.day\" + day + \" .slot\" + slot + \" .timeheading .\" + name).html();\n    };\n\n    TOOL.extract_roomname_html = function(day, r) {\n        return TOOL.extract_room_html(day, r, \"roomname\");\n    };\n\n    TOOL.extract_roomseats_html = function(day, r) {\n        return TOOL.extract_room_html(day, r, \"roomseats\");\n    };\n\n    TOOL.extract_roomtopic_html = function(day, r) {\n        return TOOL.extract_room_html(day, r, \"roomtopic\");\n    };\n\n    TOOL.extract_room_html = function(day, r, name) {\n        return $(\".day.day\" + day + \" .roomheadings .room\" + r + \" .\" + name).html();\n    };\n\n    TOOL.extract_sessionroom = function(session, returndetail) {\n        var details = [];\n        if (detail) {\n            details.push(detail);\n        } else {\n            details.push(\"name\", \"seats\", \"topic\");\n        }\n        var room = {};\n        var lang = TOOL.extract_main_language();\n        for (var i in details) {\n            var value = \"\";\n            var detail = details[i];\n            var extract = \"extract_room\" + detail + \"_txt\";\n            if (session) {\n                var span = $(session).find(\".room\" + detail);\n                if (span.length) {\n                    if (span.find(\"span.multilang\").length) {\n                        span = span.find(\"span.multilang\");\n                        if (span.find(\"[lang=\" + lang + \"]\").length) {\n                            span = span.find(\"[lang=\" + lang + \"]\");\n                        }\n                    }\n                    value = span.first().html();\n                    if (TOOL[extract]) {\n                        value = TOOL[extract](value);\n                    }\n                }\n            }\n            room[detail] = value;\n        }\n        if (returndetail) {\n            return room[returndetail];\n        } else {\n            return room;\n        }\n    };\n\n    TOOL.colspan = function(){\n        return (this.colSpan && this.colSpan > 1);\n    };\n\n    TOOL.textnodes = function(){\n        return (this.nodeType && this.nodeType===3);\n    };\n\n    // ==========================================\n    // helper functions to insert sessions\n    // ==========================================\n\n    TOOL.change_rowspan_colspan = function(session, newrowspan, newcolspan) {\n\n        var cellindex = session.prop(\"cellIndex\");\n        var oldrowspan = session.prop(\"rowspan\");\n        var oldcolspan = session.prop(\"colspan\");\n\n        if (oldrowspan==newrowspan) {\n            return true;\n        }\n\n        if (oldcolspan===undefined) {\n            oldcolspan = 0;\n        }\n        if (newcolspan===undefined) {\n            newcolspan = 0;\n        }\n\n        if (oldrowspan < newrowspan) {\n            var i = 0;\n            session.closest(\"tr\").nextAll().each(function(){\n                i++;\n                if (i < oldrowspan) {\n                    return true;\n                }\n                if (i >= newrowspan) {\n                    return false;\n                }\n                $(this).find(\"th, td\").eq(cellindex).each(function(){\n                    TOOL.unassign_session(this, true);\n                });\n            });\n        }\n\n        if (oldrowspan > newrowspan) {\n            var i = 0;\n            //var day = TOOL.extract_parent_day(this);\n            //var roomcount = TOOL.extract_roomcount(day);\n            session.closest(\"tr\").nextAll().each(function(){\n                i++;\n                if (i < newrowspan) {\n                    return true;\n                }\n                if (i >= oldrowspan) {\n                    return false;\n                }\n                var html = TOOL.html_sessions(cellindex, cellindex);\n                if (session.is(\":last-child\")) {\n                    $(this).append(html);\n                } else {\n                    $(this).find(\"th, td\").eq(cellindex).each(function(){\n                        TOOL.insert_session(html, \"insertBefore\", this);\n                    });\n                }\n            });\n        }\n\n        session.prop(\"rowspan\", newrowspan);\n    };\n\n    TOOL.unassign_session = function(session, remove) {\n        // sessions with a recognized \"id\" are moved to the \"#items\" DIV\n        var id = $(session).prop(\"id\");\n        if (id.indexOf(\"id_recordid_\")==0) {\n            $(session).removeAttr(\"id\");\n            TOOL.item(id, TOOL.get_non_jquery_classes(session))\n               .append($(session).children(TOOL.sessioncontent))\n               .appendTo(\"#items\");\n        }\n        if (remove) {\n            $(session).remove();\n        } else {\n            $(session).children().remove();\n            TOOL.insert_timeroom(session);\n            $(session).removeAttr(\"id colspan\")\n                      .removeClass(\"demo attending multiroom\")\n                      .addClass(\"emptysession\");\n        }\n    };\n\n    TOOL.insert_sessions = function(elm, r, day, roomcount) {\n        if (TOOL.empty(day)) {\n            day = TOOL.extract_parent_day(elm);\n        }\n        if (TOOL.empty(roomcount)) {\n            roomcount = TOOL.extract_roomcount(day);\n        }\n        if (r <= roomcount) {\n            var html = TOOL.html_sessions(r, roomcount);\n            TOOL.insert_session(html, \"insertAfter\", elm);\n        }\n    };\n\n    TOOL.insert_session = function(html, insert, elm) {\n        $(html).each(function(){\n            TOOL.make_sessions_editable(null, this);\n            TOOL.make_sessions_droppable(null, this);\n            TOOL.make_sessions_draggable(null, this);\n            TOOL.make_sessions_selectable(null, this);\n        })[insert](elm);\n    };\n\n    TOOL.insert_timeroom = function(elm, roomtxt) {\n        var day = TOOL.extract_parent_day(elm);\n        var slot = TOOL.extract_parent_slot(elm);\n        var room = $(elm).data(\"room\");\n        if (TOOL.empty(room)) {\n            room = $(elm).index();\n        }\n        TOOL.insert_time(elm, day, slot);\n        TOOL.insert_room(elm, day, room, roomtxt);\n    };\n\n    TOOL.insert_time = function(elm, day, slot) {\n        var html = TOOL.html_time(day, slot);\n        if ($(elm).find(\".time\").length) {\n            $(elm).find(\".time\").replaceWith(html);\n        } else {\n            $(elm).prepend(html);\n        }\n    };\n\n    TOOL.insert_room = function(elm, day, room, roomtxt) {\n        var html = TOOL.html_room(day, room, roomtxt);\n        if ($(elm).find(\".room\").length) {\n            $(elm).find(\".room\").replaceWith(html);\n        } else if ($(elm).find(\".time\").length) {\n            $(elm).find(\".time\").after(html);\n        } else {\n            $(elm).prepend(html);\n        }\n    };\n\n    TOOL.get_non_jquery_classes = function(elm) {\n        var classes = $(elm).prop('class').split(new RegExp(\"\\\\s+\"));\n        var max = (classes.length - 1);\n        for (var i=max; i>=0; i--) {\n            if (classes[i].indexOf(\"ui-\")==0) {\n                classes.splice(i, 1);\n            }\n        }\n        return classes.join(\" \");\n    };\n\n    // ==========================================\n    // helper functions to create jQuery objects\n    // ==========================================\n\n    TOOL.tab = function(day, tabtext) {\n        var html = TOOL.html_tab(day, tabtext);\n        return $(html).each(function(){\n            TOOL.make_day_editable(this);\n        });\n    };\n\n    TOOL.day = function(day, daytext, roomcount, slotcount, slotstart, slotlength, slotinterval) {\n        var html = TOOL.html_day(day, daytext, roomcount, slotcount, slotstart, slotlength, slotinterval);\n        return $(html).each(function(){\n            TOOL.make_day_editable(this);\n        });\n    };\n\n    TOOL.roomheadings = function(day, rooms, topics) {\n        // if possible we clone another row of roomheadings\n        var headings = $(\".day.day\" + day + \" .roomheadings\");\n        if (headings.length) {\n            return headings.first().clone();\n        }\n        headings = $(TOOL.html_roomheadings(day, rooms, topics));\n        TOOL.make_rooms_editable(null, headings);\n        return headings;\n    };\n\n    TOOL.roomheading = function(r, roomtxt, roomtopic) {\n        var roomname = TOOL.extract_roomname_txt(roomtxt);\n        var roomseats = TOOL.extract_roomseats_txt(roomtxt);\n        var heading = $(TOOL.html_roomheading(r, roomname, roomseats, roomtopic));\n        heading.prepend(TOOL.icons(\"room\"));\n        return heading;\n    };\n\n    TOOL.slot = function(targetday, startfinish, duration) {\n        var slot = $(TOOL.html_slot(targetday, startfinish, duration, TOOL.extract_roomcount(targetday)));\n        TOOL.make_slots_editable(null, slot);\n        TOOL.make_sessions_droppable(slot);\n        TOOL.make_sessions_draggable(slot);\n        TOOL.make_sessions_selectable(slot);\n        return slot;\n    };\n\n    TOOL.item = function(id, classess){\n        var item = $(TOOL.html_item(id, classess));\n        TOOL.make_sessions_draggable(null, item);\n        TOOL.make_sessions_selectable(null, item);\n        return item;\n    };\n\n    TOOL.icons = function(type, actions) {\n        var icons = document.createElement(\"SPAN\");\n        icons.setAttribute(\"class\", \"icons\");\n        if (TOOL.empty(actions)) {\n            actions = [\"edit\", \"remove\"];\n        } else if (typeof(actions)==\"string\") {\n            actions = [actions];\n        }\n        for (var i in actions) {\n            var action = actions[i];\n            var clickhandler = action + \"_\" + type;\n            var icon = document.createElement(\"IMG\");\n            icon.setAttribute(\"src\", TOOL[\"icon\" + action]);\n            icon.setAttribute(\"title\", TOOL.str[action + type]);\n            icon.setAttribute(\"class\", \"icon\");\n            icon.setAttribute(\"clickhandler\", clickhandler);\n            if (TOOL[clickhandler]) {\n                $(icon).click(TOOL[clickhandler]);\n            } else {\n                $(icon).click(TOOL.noclickhandler);\n            }\n            icons.appendChild(icon);\n        }\n        return icons;\n    };\n\n    TOOL.noclickhandler = function(){\n        alert(\"Oops, click handler is missing: TOOL.\" + this.getAttribute(\"clickhandler\") + \"()\");\n    };\n\n    // ==========================================\n    // helper functions to create HTML elements\n    // ==========================================\n\n    TOOL.html_day = function(day, daytext, roomcount, slotcount, slotstart, slotlength, slotinterval) {\n        var html = \"\";\n        html += HTML.starttag(\"tbody\", {\"class\": \"day day\" + day});\n\n        // day text\n        html += HTML.starttag(\"tr\", {\"class\": \"date\"});\n        html += HTML.tag(\"td\", daytext, {\"colspan\": roomcount});\n        html += HTML.endtag(\"tr\");\n\n        // room headings\n        html += TOOL.html_roomheadings(day, null, null, roomcount);\n\n        // slots\n        var starttime = null;\n        var finishtime = null;\n        var startfinish = null;\n        for (var s=1; s<=slotcount; s++) {\n            if (TOOL.empty(starttime)) {\n                starttime = slotstart;\n            } else {\n                starttime = finishtime + slotinterval;\n            }\n            finishtime = starttime + slotlength;\n            startfinish = TOOL.form_startfinish(Math.floor(starttime / 60),\n                                               (starttime % 60),\n                                               Math.floor(finishtime / 60),\n                                               (finishtime % 60));\n            html += TOOL.html_slot(day, startfinish, slotlength, roomcount);\n        }\n\n        html += HTML.endtag(\"tbody\");\n        return html;\n    };\n\n    TOOL.html_tab = function(day, tabtext) {\n        return HTML.tag(\"div\", tabtext, {\"class\": \"tab day\" + day});\n    };\n\n    TOOL.html_roomheadings_toprow = function() {\n        return HTML.starttag(\"tr\")\n               + HTML.tag(\"td\", \"\")\n               + TOOL.boldcenter(\"td\", TOOL.str.room)\n               + TOOL.boldcenter(\"td\", TOOL.str.roomtopic)\n               + HTML.endtag(\"tr\");\n    };\n\n    TOOL.html_roomheadings_datarow = function(elm, r) {\n        var room = TOOL.extract_sessionroom(elm);\n        return HTML.starttag(\"tr\")\n               + HTML.tag(\"th\", r)\n               + HTML.tag(\"td\", TOOL.rooms(\"room_\" + r, room.name))\n               + HTML.tag(\"td\", HTML.text(\"topic_\" + r, room.topic))\n               + HTML.endtag(\"tr\");\n    };\n\n    TOOL.html_roomheadings_lastrow = function() {\n        var options = {};\n        options[TOOL.APPLY_CURRENT] = TOOL.str.currentheadings;\n        options[TOOL.APPLY_THISDAY] = TOOL.str.allheadingsthisday;\n        options[TOOL.APPLY_ALLDAYS] = TOOL.str.allheadingsalldays;\n        return HTML.starttag(\"tr\")\n               + HTML.tag(\"th\", TOOL.str.applyto)\n               + HTML.tag(\"td\", HTML.select(\"applyto\", options, TOOL.APPLY_CURRENT, {}))\n               + HTML.endtag(\"tr\");\n    };\n\n    TOOL.html_roomheading = function(r, roomname, roomseats, roomtopic) {\n        return HTML.starttag(\"th\", {\"class\": \"roomheading room\" + r})\n             + HTML.tag(\"span\", roomname,  {\"class\": \"roomname\"})\n             + HTML.tag(\"span\", roomseats, {\"class\": \"roomseats\"})\n             + HTML.tag(\"div\",  roomtopic, {\"class\": \"roomtopic\"})\n             + HTML.endtag(\"th\");\n    };\n\n    TOOL.html_roomheadings = function(day, rooms, topics, roomcount) {\n        if (TOOL.empty(roomcount)) {\n            roomcount = TOOL.extract_roomcount(day);\n        }\n        var html = \"\";\n        html += HTML.starttag(\"tr\", {\"class\": \"roomheadings\"});\n        html += HTML.tag(\"th\", \"\", {\"class\": \"timeheading\"});\n        for (var r=1; r<=roomcount; r++) {\n            if (TOOL.empty(rooms) || TOOL.empty(rooms[r]) || rooms[r]==\"0\") {\n                var roomname = TOOL.str.roomname + \" (\" + r + \")\";\n                var roomseats = 40;\n                var roomtopic = TOOL.str.roomtopic + \" (\" + r + \")\";\n            } else {\n                var roomname = TOOL.extract_roomname_txt(rooms[r]);\n                var roomseats = TOOL.extract_roomseats_txt(rooms[r]);\n                var roomtopic = TOOL.trim(topics[r]);\n            }\n            html += TOOL.html_roomheading(r, roomname, roomseats, roomtopic);\n        }\n        html += HTML.endtag(\"tr\");\n        return html;\n    };\n\n    TOOL.html_timeroom = function(day, slot, room, roomtxt) {\n        return TOOL.html_time(day, slot) + TOOL.html_room(day, room, roomtxt);\n    };\n\n    TOOL.html_time = function(day, slot) {\n        var startfinish = TOOL.extract_startfinish_html(day, slot);\n        var duration = TOOL.extract_duration_html(day, slot);\n        var html = HTML.tag(\"span\", startfinish, {\"class\": \"startfinish\"})\n                 + HTML.tag(\"span\", duration, {\"class\": \"duration\"});\n        return HTML.tag(\"div\", html, {\"class\": \"time\"});\n    };\n\n    TOOL.html_room = function(day, room, roomtxt) {\n        if (roomtxt==\"0\") {\n            return \"\";\n        }\n        if (TOOL.empty(roomtxt)) {\n            var roomname = TOOL.extract_roomname_html(day, room);\n            var roomseats = TOOL.extract_roomseats_html(day, room);\n            var roomtopic = TOOL.extract_roomtopic_html(day, room);\n        } else {\n            var roomname = TOOL.extract_roomname_txt(roomtxt);\n            var roomseats = TOOL.extract_roomseats_txt(roomtxt);\n            var roomtopic = \"\";\n        }\n        var html = HTML.tag(\"span\", roomname, {\"class\": \"roomname\"})\n                 + HTML.tag(\"span\", roomseats, {\"class\": \"roomseats\"})\n                 + HTML.tag(\"div\", roomtopic, {\"class\": \"roomtopic\"});\n        return HTML.tag(\"div\", html, {\"class\": \"room\"});\n    };\n\n    TOOL.html_item = function(id, classes) {\n        if (TOOL.empty(classes)) {\n            classes = \"session\";\n        }\n        var attr = {\"class\": classes};\n        if (id) {\n            attr.id = id;\n        }\n        return HTML.tag(\"div\", \"\", attr);\n    };\n\n    TOOL.html_sessions = function(r_min, r_max) {\n        var html = \"\";\n        for (var r=r_min; r<=r_max; r++) {\n            html += HTML.tag(\"td\", \"\", {\"class\": \"session emptysession\"});\n        }\n        return html;\n    };\n\n    TOOL.html_slot = function(day, startfinish, duration, roomcount) {\n        var html = \"\";\n        var durationtxt = TOOL.get_string(\"durationtxt\", duration);\n        html += HTML.starttag(\"tr\", {\"class\": \"slot duration\" + duration});\n        html += HTML.starttag(\"td\", {\"class\": \"timeheading\"});\n        html += HTML.tag(\"span\", startfinish, {\"class\": \"startfinish\"});\n        html += HTML.tag(\"span\", durationtxt, {\"class\": \"duration\"});\n        html += HTML.endtag(\"td\");\n        html += TOOL.html_sessions(1, roomcount);\n        html += HTML.endtag(\"tr\");\n        return html;\n    };\n\n    TOOL.get_string = function(name, insert) {\n        if (TOOL.empty(name) || TOOL.empty(TOOL.str[name])) {\n            return \"\";\n        }\n        var str = TOOL.str[name];\n        if (insert || insert===0) {\n            if (typeof(insert)==\"string\" || typeof(insert)==\"number\") {\n                var a = new RegExp(\"\\\\{\\\\$a\\\\}\", \"g\");\n                str = TOOL.str[name].replace(a, insert);\n            } else {\n                for (var i in insert) {\n                    var a = new RegExp(\"\\\\{\\\\$a->\" + i + \"\\\\}\", \"g\");\n                    str = str.replace(a, insert[i]);\n                }\n            }\n        }\n        return str;\n    };\n\n    TOOL.hours = function(name, selected, min, max, attr) {\n        var pad = (TOOL.empty(min) && TOOL.empty(max));\n        if (TOOL.empty(min)) {\n            min = 0;\n        }\n        if (TOOL.empty(max)) {\n            max = 23;\n        }\n        if (TOOL.empty(attr)) {\n            attr = {};\n        }\n        if (TOOL.empty(attr.class)) {\n            attr.class = \"select\" + name;\n        }\n        var options = {};\n        for (var i=min; i<=max; i++) {\n            if (pad) {\n                options[i] = TOOL.pad(i);\n            } else {\n                options[i] = TOOL.get_string(\"numhours\", i);\n            }\n        }\n        return HTML.select(name, options, selected, attr);\n    };\n\n    TOOL.mins = function(name, selected, min, max, attr) {\n        var pad = (TOOL.empty(min) && TOOL.empty(max));\n        if (TOOL.empty(min)) {\n            min = 0;\n        }\n        if (TOOL.empty(max)) {\n            max = 59;\n        }\n        if (TOOL.empty(attr)) {\n            attr = {};\n        }\n        if (TOOL.empty(attr.class)) {\n            attr.class = \"select\" + name;\n        }\n        var options = {};\n        for (var i=min; i<=max; i+=5) {\n            if (pad) {\n                options[i] = TOOL.pad(i);\n            } else {\n                options[i] = TOOL.get_string(\"nummins\", i);\n            }\n        }\n        return HTML.select(name, options, selected, attr);\n    };\n\n    TOOL.hoursmins = function(name, hours, mins) {\n        var hours  = TOOL.hours(name + \"hours\", hours);\n        var mins = TOOL.mins(name + \"mins\", mins);\n        return hours + ' : ' + mins;\n    };\n\n    TOOL.range = function(name, selected, min, max, attr) {\n        if (TOOL.empty(name)) {\n            return \"\";\n        }\n        if (TOOL.empty(min)) {\n            min = 1;\n        }\n        if (TOOL.empty(max)) {\n            max = 10;\n        }\n        if (TOOL.empty(selected)) {\n            selected = max;\n        }\n        if (TOOL.empty(attr)) {\n            attr = {};\n        }\n        if (attr.class) {\n            attr.class = \"select\" + name;\n        }\n        var options = {};\n        for (var i=min; i<=max; i++) {\n            options[i] = i;\n        }\n        return HTML.select(name, options, selected, attr);\n    };\n\n\n    TOOL.position = function(type, max, name, attr) {\n        if (type) {\n            type = TOOL.get_string(type).toLowerCase();\n        }\n        if (TOOL.empty(name)) {\n            name = \"position\";\n        }\n        if (TOOL.empty(attr)) {\n            attr = {};\n        }\n        var positions = {};\n        for (var i=1; i<=max; i++) {\n            if (TOOL.empty(type)) {\n                positions[i] = i;\n            } else {\n                var a = {\"type\": type, \"num\": i};\n                positions[i] = TOOL.get_string(\"positionbefore\", a);\n            }\n        }\n        positions[i] = TOOL.str.positionlast;\n        return HTML.select(name, positions, i, attr);\n    };\n\n    TOOL.days_select = function(name) {\n        var selected = TOOL.extract_active_day();\n        var lang = TOOL.extract_main_language();\n        var options = {};\n        $(\".tab\").each(function(){\n            var day = TOOL.extract_day($(this).prop(\"class\"));\n            var html = $(this).find(\"span.multilang[lang=\" + lang + \"]\");\n            if (html.length) {\n                html = html.html();\n            } else {\n                html = $(this).html();\n            }\n            options[day] = TOOL.force_single_line(html);\n        });\n        return HTML.select(name, options, selected, {});\n    };\n\n    TOOL.days_checkbox = function(name) {\n        var html = \"\";\n        var heading = TOOL.str.day;\n        var checked = TOOL.extract_active_day();\n        $(\".day\").each(function(){\n            var day = TOOL.extract_parent_day(this);\n            var dayname = name + \"_\" + day;\n            var daytext = TOOL.extract_parent_daytext(this);\n            daytext = HTML.tag(\"label\", daytext, {\"for\": \"id_\" + dayname});\n            daytext = HTML.checkbox(dayname, (day==checked)) + \" \" + daytext;\n            html += HTML.starttag(\"tr\", {\"valign\": \"top\"})\n                 + HTML.tag(\"th\", heading)\n                 + HTML.tag(\"td\", daytext, {\"colspan\": \"2\"})\n                 + HTML.endtag(\"tr\");\n            heading = \"\";\n        });\n        return html;\n    };\n\n    TOOL.days = function(name, value, attr) {\n        return TOOL.clone_menu(\"schedule_day\", name, value, attr);\n    };\n\n    TOOL.rooms = function(name, value, attr) {\n        return TOOL.clone_menu(\"schedule_roomname\", name, value, attr);\n    };\n\n    TOOL.categories = function(name, value, attr) {\n        return TOOL.clone_menu(\"presentation_category\", name, value, attr);\n    };\n\n    TOOL.types = function(name, value, attr) {\n        return TOOL.clone_menu(\"presentation_type\", name, value, attr);\n    };\n\n    TOOL.topics = function(name, value, attr) {\n        return TOOL.clone_menu(\"presentation_topic\", name, value, attr);\n    };\n\n    TOOL.clone_menu = function(menuname, name, value, attr) {\n        var menu = $(\"select[name=\" + menuname + \"]\");\n        if (menu.length==0) {\n            return \"\";\n        }\n        menu = menu.first().clone();\n        return TOOL.dialog_menu(menu, name, value, attr);\n    };\n\n    TOOL.times = function(name, value, attr) {\n        return TOOL.generate_menu(\"times\", name, value, attr);\n    };\n\n    TOOL.keywords = function(name, value, attr) {\n        return TOOL.generate_menu(\"keywords\", name, value, attr);\n    };\n\n    TOOL.generate_menu = function(selector, name, value, attr) {\n        var i = 0;\n        var count = {};\n        $(\"#items .scheduleinfo .\" + selector + \" .text\").each(function(){\n            var txt = $(this).text();\n            if (count[txt]) {\n                count[txt]++;\n            } else {\n                count[txt] = 1;\n            }\n            i++;\n        });\n        if (i==0) {\n            return \"\";\n        }\n        // prepare menu for sorting\n        var menu = [];\n        for (var txt in count) {\n            menu.push([txt, count[txt]]);\n        }\n        // sort by count DESC, txt ASC\n        menu.sort(function(a, b) {\n            return (a[1] < b[1] ? 1 : (a[1] > b[1] ? -1 : (a[0] < b[0] ? -1 : (a[0] > b[0] ? 1 : 0))));\n        });\n        // generate OPTION tags\n        for (var i=0; i<menu.length; i++) {\n            var txt = menu[i][0] + \" (\" + menu[i][1] + \")\";\n            menu[i] = HTML.tag(\"option\", txt, {\"value\": txt});\n        }\n        // generate SELECT element\n        menu = $(HTML.tag(\"select\", menu.join(\"\")));\n        return TOOL.dialog_menu(menu, name, value, attr);\n    };\n\n    TOOL.dialog_menu = function(menu, name, value, attr) {\n        menu.prop(\"name\", name);\n        menu.prop(\"id\", \"id_\" + name);\n\n        // tidy up option values\n        // =========================================\n        // THIS CODE WAS COMMENTED OUT ON 2019-07-22\n        // because changing the menu values is not\n        // desirable for a menu of rooms\n        // =========================================\n        //var info = new RegExp(\"\\\\([^()]*\\\\)$\");\n        //menu.find(\"option\").each(function(){\n        //    var v = TOOL.trim($(this).val().replace(info, \"\"));\n        //    if (v===\"0\") {\n        //        v = \"\";\n        //    }\n        //    this.setAttribute(\"value\", v);\n        //});\n\n        // set selected item, if any\n        if (value) {\n            value = value.replace(new RegExp(' style=\"[^\"]*\"', \"g\"), \"\");\n            value = value.replace(new RegExp(\"[\\\\r\\\\n]+\", \"g\"), \"\");\n            value = TOOL.trim(value);\n            var found = false;\n            menu.find(\"option\").each(function(){\n                var v = $(this).val();\n                window.console.log(\"v=\"+v+\", value=\"+value);\n                if (found==false && v && (v.indexOf(value)==0 || value.indexOf(v)==0)) {\n                    found = true;\n                    this.selected = true;\n                    this.setAttribute(\"selected\", \"selected\");\n                } else {\n                    this.selected = false;\n                    this.removeAttribute(\"selected\");\n                }\n            });\n        }\n\n        // set attributes\n        if (attr) {\n            if (attr.size) {\n                var size = menu.find(\"option:not(:empty)\").length;\n                size = Math.min(size, attr.size);\n                if (size <= 1) {\n                    delete(attr.size);\n                    delete(attr.multiple);\n                } else {\n                    attr.size = size;\n                    attr.multiple = \"multiple\";\n                    menu.find(\"option:empty\").remove();\n                }\n            }\n            for (var a in attr) {\n                menu.prop(a, attr[a]);\n            }\n        }\n\n        // shorten displayed text\n        var i = 0;\n        menu.find(\"option\").each(function(){\n            var txt = $(this).text();\n            $(this).prop(\"title\", txt);\n            $(this).text(UNICODE.shorten(txt));\n            if (txt) {\n                i++;\n            }\n        });\n\n        if (i==0) {\n            return \"\";\n        }\n\n        return menu.prop(\"outerHTML\");\n    };\n\n    TOOL.boldcenter =function(tag, content) {\n        var attr = {\"align\": \"center\"};\n        return HTML.tag(\"td\", HTML.tag(\"b\", content), attr);\n    };\n\n    TOOL.multilang =function(content, lang) {\n        var attr = {\"class\": \"multilang\",\n                    \"lang\": lang};\n        return HTML.tag(\"span\", content, attr);\n    };\n\n    TOOL.multilangs = function(elm, name) {\n        var values = TOOL.form_multilang_values(elm, name);\n        var value = \"\";\n        var multilangs = [];\n        for (var lang in values) {\n            value = values[lang];\n            multilangs.push(TOOL.multilang(value, lang));\n        }\n        if (multilangs.length < 2) {\n            return value;\n        }\n        return multilangs.join(\"\");\n    };\n\n    // ==========================================\n    // helper functions to manipulate strings\n    // ==========================================\n\n    TOOL.force_simple_html = function(html) {\n        // remove all tags, except those allowed for formatting\n        var tags = \"br|hr|b|i|u|em|strong|big|small|sup|sub|tt|var\";\n        return html.replace(new RegExp(\"<(/?\\\\w+)\\\\b[^>]*>\", \"g\"), \"<$1>\")\n                   .replace(new RegExp(\"</([^>]*)>\", \"g\"), \"<$1/>\")\n                   .replace(new RegExp(\"<(?!\" + tags + \")[^>]*>\", \"g\"), \"\")\n                   .replace(new RegExp(\"<([^>]*)/>\", \"g\"), \"</$1>\");\n    };\n\n    TOOL.force_single_line = function(html) {\n        var linebreak = new RegExp(\"<br\\\\b[^>]*>\", \"g\");\n        return TOOL.trim(html.replace(linebreak, \" \"));\n    };\n\n    TOOL.pad = function(txt, padlength, padchar, padleft) {\n        if (TOOL.empty(txt)) {\n            return \"\";\n        } else {\n            txt += \"\";\n        }\n        if (TOOL.empty(padlength)) {\n            padlength = 2;\n        }\n        if (TOOL.empty(padchar)) {\n            padchar = (isNaN(txt) ? \" \" : \"0\");\n        }\n        if (TOOL.empty(padleft)) {\n            padleft = (isNaN(txt) ? false : true);\n        }\n        while (txt.length < padlength) {\n            if (padleft) {\n                txt = (padchar + txt);\n            } else {\n                txt = (txt + padchar);\n            }\n        }\n        return txt;\n    };\n\n    TOOL.trim = function(str) {\n        if (TOOL.empty(str)) {\n            return \"\";\n        } else {\n            str += \"\";\n        }\n        var inner = new RegExp(\"\\\\s+\", \"g\");\n        var outer = new RegExp(\"(^\\\\s+)|(\\\\s+$)\", \"g\");\n        return str.replace(outer, \"\").replace(inner, \" \");\n    };\n\n    // ==========================================\n    // get form values\n    // ==========================================\n\n    TOOL.form_startfinish = function(starthours, startmins, finishhours, finishmins) {\n        return TOOL.pad(starthours) + TOOL.str.labelsep + TOOL.pad(startmins) +\n               TOOL.str.durationseparator +\n               TOOL.pad(finishhours) + TOOL.str.labelsep + TOOL.pad(finishmins);\n    };\n\n    TOOL.form_duration = function(starthours, startmins, finishhours, finishmins) {\n        var duration = 0;\n        if (finishhours < starthours) {\n            duration = 23;\n        }\n        if (finishhours == starthours && finishmins <= startmins) {\n            duration = 23; // very unusual, probably a mistake\n        }\n        duration = (60 * (duration + finishhours - starthours));\n        duration = TOOL.pad(duration + finishmins - startmins);\n        return duration;\n    };\n\n    TOOL.form_value = function(elm, name, returnnumber) {\n        var x = $(elm).find(\"[name=\" + name + \"]\");\n        if (x.length) {\n            switch (true) {\n                case x.is(\"select\"): x = x.find(\"option:selected\"); break;\n                case x.is(\"input[type=radio]\"): x = x.find(\"input:checked\"); break;\n                case x.is(\"input[type=checkbox]\"): x = (x.is(\":checked\") ? x : \"\"); break;\n            }\n        }\n        if (x.length==0) {\n            return (returnnumber ? 0 : \"\");\n        }\n        if (x.length==1) {\n            x = x.val();\n            return (returnnumber ? parseInt(x) : x);\n        }\n        var values = [];\n        for (var i=0; i<x.length; i++) {\n            values.push(returnnumber ? parseInt(x[i].value) : x[i].value);\n        }\n        return values;\n    };\n\n    TOOL.form_values = function(elm, prefix, returnnumber) {\n        var values = [];\n        $(elm).find(\"[name^=\" + prefix + \"]\").each(function(){\n            var name = $(this).prop(\"name\");\n            if (name==prefix) {\n                values = TOOL.form_value(elm, prefix, returnnumber);\n            } else {\n                var i = parseInt(name.substr(prefix.length));\n                values[i] = TOOL.form_value(elm, name, returnnumber);\n            }\n        });\n        return values;\n    };\n\n    TOOL.form_multilang_values = function(elm, name) {\n        var values = {};\n        var lang, value;\n        $(elm).find(\"input[name^=\" + name + \"]\").each(function(){\n            lang = $(this).prop(\"name\").substr(name.length + 1);\n            value = value = TOOL.trim($(this).val());\n            if (value) {\n                values[lang] = TOOL.force_simple_html(value);\n            }\n        });\n        return values;\n    };\n\n    TOOL.empty = function(v) {\n        return (v===undefined || v===null);\n    };\n\n    TOOL.fix_multislot_times = function(schedule){\n\n        var r1 = new RegExp(\"^ *([0-9]+) *: *([0-9]+) *\");\n        var r2 = new RegExp(\" *([0-9]+) *: *([0-9]+) *$\");\n        var m = null; // matched time parts\n\n        schedule.querySelectorAll(\".session[rowspan]\").forEach(function(s){\n            // remove superfluous rowspan\n            if (s.rowSpan == 1) {\n                s.removeAttribute(\"rowspan\");\n                return;\n            }\n            // s1 (heading of first slot)\n            // s2 (heading of last slot)\n            var times = new Array();\n            var s1 = s.parentNode;\n            var s2 = s1;\n            var i = 1;\n            while (s2 && i < s.rowSpan) {\n                s2 = s2.nextElementSibling;\n                i++;\n            }\n            // get time range for first slot\n            if (s1) {\n                s1 = s1.querySelector(\".timeheading .startfinish\");\n                if (s1) {\n                    s1 = s1.innerText;\n                }\n            } else {\n                s1 = \"\";\n            }\n            // get time range for last slot\n            if (s2) {\n                s2 = s2.querySelector(\".timeheading .startfinish\");\n                if (s2) {\n                    s2 = s2.innerText;\n                }\n            } else {\n                s2 = \"\";\n            }\n            // extract start time of first slot\n            m = r1.exec(s1);\n            if (m) {\n                times.push(m[1] + \":\" + m[2]);\n                s1 = parseInt(60 * m[1]) + parseInt(m[2]);\n            }\n            // extract end time of last slot\n            m = r2.exec(s2);\n            if (m) {\n                times.push(m[1] + \":\" + m[2]);\n                s2 = parseInt(60 * m[1]) + parseInt(m[2]);\n            }\n            if (s1 && s2) {\n                // fix end time just after midnight\n                if (s2 < s1) {\n                    s2 += parseInt(24 * 60); // 24 hours\n                }\n                // set accurate duration for this session\n                var elm = s.querySelector(\".duration\");\n                if (elm) {\n                    elm.innerText = (s2 - s1) + \" mins\";\n                }\n                // set accurate startfinish for this session\n                var elm = s.querySelector(\".startfinish\");\n                if (elm) {\n                    elm.innerText = times.join(\" - \");\n                }\n            }\n        });\n    };\n\n    return TOOL;\n});\n"],"file":"tool_setupschedule.min.js"}